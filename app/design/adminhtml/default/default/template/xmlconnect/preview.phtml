<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>

<div id="XmlconnectThemePreview">
    <img src="<?php echo $this->getThemeImage(); ?>"
        width="320" height="481" alt="Theme Preview" title="Theme Preview" />
</div>
<div class="mm-box-blue a-center" style="width:280px;">
    <button type="button" class="scalable" onclick="updatePreview()"><span>Update Preview</span></button>
</div>
<div class="mm-pager">
    <strong>Screens:</strong>
    <ul id="mmPager">
        <li><a class="active" href="#">1</a></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
        <li><a href="#">4</a></li>
    </ul>
</div>
<script type="text/javascript">
    mmPreviewPage = 1
    function updatePreview() {
        if (!$('XmlconnectThemePreviewIframe')) {
            html = '<iframe src="" id="XmlconnectThemePreviewIframe"'
            html += ' name="XmlconnectThemePreviewIframe" scrolling="no"'
            html += ' style="width: 320px; height: 481px; border: 0; "></iframe>';
            $('XmlconnectThemePreview').innerHTML = html
        }
        saveAction = $('edit_form').action
        $('edit_form').action += 'preview/'+mmPreviewPage+'/';
        $('edit_form').target = 'XmlconnectThemePreviewIframe'
        $('edit_form').submit()
        // FIXME
        $('edit_form').action = saveAction
        $('edit_form').target = ''
    }
    $('mmPager').childElements().each(function(t){
        Event.observe(t.down('a'), 'click', function(e){
            e.stop();
            resetPager();
            t.down('a').addClassName('active');
            mmPreviewPage = t.down('a').innerHTML
        });
    });
    function resetPager(){
        $('mmPager').childElements().each(function(t){
            t.down('a').removeClassName('active');
        });
    }
</script>
