<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design
 * @package    enterprise_default
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>

<?php
$_htmlId = $this->getHtmlId() ? $this->getHtmlId() : '_' . uniqid();
?>
<button style="" onclick="" class="scalable" type="button" id="generateBtn<?php echo $_htmlId ?>">
    <span><?php echo Mage::helper('enterprise_giftcardaccount')->__('Generate'); ?></span>
</button>
<br />
<p class="nm"><small>
<?php
$_usage = $this->getUsage();
echo Mage::helper('enterprise_giftcardaccount')->__(
    'Code Pool used: <b>%.2f%%</b> (free <b>%d</b> of <b>%d</b> total).',
    $_usage->getPercent(),
    $_usage->getFree(),
    $_usage->getTotal()
);
?>
</small></p>
<br />

<script type="text/javascript">
//<![CDATA[
function redirectToGeneration()
{
    var url = '<?php echo Mage::getSingleton('adminhtml/url')->getUrl('*/manage_giftcardaccount/generate'); ?>';
    if (confirm('<?php echo Mage::helper('enterprise_giftcardaccount')->__('Do you really want to proceed? All unsaved changes will be lost.'); ?>')) {
        window.location.href = url;
    }
}

Event.observe('generateBtn<?php echo $_htmlId ?>', 'click', redirectToGeneration)
//]]>
</script>
