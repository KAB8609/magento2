<?php
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2009 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
?>
<script type="text/javascript">
//<![CDATA[
    var paymentObj = parent.payment;
    var parentElementObj = parent.Element;

    function setPaymentMethod()
    {
        var checkoutForm = parent.document.getElementById('edit_form');
        var elements = parent.Form.getElements('edit_form');
        for (var i=0; i<elements.length; i++) {
            if (elements[i].name=='payment[method]')    {
                elements[i].checked = false;
                // elements[i].disabled = true;
            }
        }

        var method = new parentElementObj('input', {
            'type':    'radio',
            'name':    'payment[method]',
            'value':   'pbridge',
            'checked': 'checked',
            'style':   'display:none'
        });

        checkoutForm.appendChild(method);

        var jsonParams = <?php echo $this->getJsonHiddenPbridgeParams() ?>;
        var methodParam;
        parent.$H(jsonParams).each(function(param) {
            methodParam = new parentElementObj('input', {
                'type':  'hidden',
                'name':  'payment[pbridge_data][' + param.key + ']',
                'value': param.value
            });
            checkoutForm.appendChild(methodParam);
        });
        var message = document.getElementById('payment-method-message');
        // parent.order.switchPaymentMethod('pbridge');
        message.innerHTML = '<?php echo Mage::helper('enterprise_pbridge')->__('Payment Bridge Selected') ?>';
    }
    window.onload = setPaymentMethod;
//]]>
</script>

<div id="payment-method-message"></div>
