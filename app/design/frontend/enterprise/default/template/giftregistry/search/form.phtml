<?php
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   Copyright (c) 2009 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
?>
<div class="page-title">
    <h1><?php echo $this->getFormHeader() ?></h1>
</div>
<span id="gr-please-wait" class="please-wait" style="display:none;">
    <img src="<?php echo $this->getSkinUrl('images/opc-ajax-loader.gif') ?>" alt="" class="v-middle" /> <?php echo $this->__('Please wait, loading...') ?>
</span>

<?php echo $this->getMessagesBlock()->getGroupedHtml(); ?>
<form action="<?php echo $this->getSearchUrl() ?>" method="post" id="gr_search_form">
    <div class="fieldset">
        <?php echo $this->getBlockHtml('formkey')?>
        <h2 class="legend"><?php echo $this->__('Search Options') ?></h2>
        <ul class="form-list">
            <li class="fields">
                <div class="field">
                    <label for="search_type" class="required"><em>*</em><?php echo $this->__('Gift Registry Type:') ?></label>
                    <div class="input-box">
                        <?php echo $this->getTypeSelectHtml() ?>
                    </div>
                </div>
                <div class="field">
                    <label for="search_firstname" class="required"><em>*</em><?php echo $this->__('First Name:') ?></label>
                     <div class="input-box">
                        <input name="search[firstname]" id="search_firstname" type="text" class="input-text required-entry" />
                    </div>
                </div>
                <div class="field">
                    <label for="search_lastname" class="required"><em>*</em><?php echo $this->__('Last Name:') ?></label>
                    <div class="input-box">
                        <input name="search[lastname]" id="search_lastname" type="text" class="input-text required-entry" />
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="fieldset" id="gr-type-specific-fieldset" style="display:none;">
        <h2 class="legend"><?php echo $this->__('Type Specific Options') ?></h2>
        <ul class="form-list">
            <li class="fields" id="gr-type-specific-options">
            </li>
        </ul>
    </div>

    <div class="buttons-set form-buttons">
        <button type="submit" class="button"><span><span><?php echo $this->__('Search') ?></span></span></button>
    </div>
    <p class="required"><?php echo $this->__('* Required Fields') ?></p>
</form>
<script type="text/javascript">
//<![CDATA[
var giftRegistrySearchForm = new VarienForm('gr_search_form');

function advancedFormUpdate() {
    new Ajax.Updater('gr-type-specific-options', '<?php echo $this->getAdvancedUrl() ?>', {
        onCreate: function() {
            $('gr-please-wait').show()
        },
        onComplete: function() {
            $('gr-please-wait').hide();
            $('gr-type-specific-fieldset').show();
        },
        parameters : {type_id : $('search_type').value}
    });
}
$('search_type').observe('change', advancedFormUpdate);
//]]>
</script>

<?php if ($this->getSearchResults()): ?>
<div class="fieldset">
    <h2 class="legend"><?php echo $this->__('Search Results') ?></h2>
</div>

<table class="data-table" id="giftregistry-search-results">
    <thead>
        <tr>
            <th><?php echo $this->__('Name') ?></th>
            <th><?php echo $this->__('Location') ?></th>
            <th class="a-center"><?php echo $this->__('Title') ?></th>
            <th class="a-center"><?php echo $this->__('Type') ?></th>
            <th class="a-center"><?php echo $this->__('Event Date') ?></th>
            <th class="a-center"></th>
        </tr>
    </thead>
    <tbody>
    <?php foreach((array)$this->getSearchResults() as $item): ?>
        <tr>
            <td><?php echo $item['registrant'] ?></td>
            <td><?php echo $item['event_location'] ?></td>
            <td><?php echo $item['title'] ?></td>
            <td><?php echo $item['type'] ?></td>
            <td><?php echo $item['event_date'] ?></td>
            <td><a href=""><?php echo $this->__('View') ?></a></td>
        </tr>
    <?php endforeach; ?>
    </tbody>
</table>
<script type="text/javascript">decorateTable('giftregistry-search-results')</script>
<?php endif; ?>
