<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2009 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>


<input type="hidden" name="entity_id" id="entity_id" value="<?php echo $this->getEntity()->getEntityId(); ?>"/>
<input type="hidden" name="type_id" id="type_id" value="<?php echo $this->getTypeId(); ?>"/>
<div class="fieldset">
    <h2 class="legend"><?php echo $this->__('Main Data') ?></h2>
    <ul class="form-list">
        <li>
            <label for="type_id"><?php echo $this->__('Selected Type') ?></label>
            <div><?php echo $this->getTypeLabel(); ?></div>
        </li>
        <li>
            <label for="title" class="required"><em>*</em><?php echo $this->__('Title') ?></label>
            <div class="input-box">
                <input type="text" name="title" id="title" value="<?php echo $this->htmlEscape($this->getEntity()->getTitle());?>" title="<?php echo $this->__('Title') ?>" class="input-text required-entry" />
            </div>
        </li>
        <li>
            <label for="message" class="required"><em>*</em><?php echo $this->__('Message') ?></label>
            <textarea name="message" id="message" rows="3" class="required-entry" ><?php echo $this->htmlEscape($this->getEntity()->getMessage());?></textarea>
        </li>
        <li>
            <label for="is_public" class="required"><em>*</em><?php echo $this->__('Privacy Setings') ?></label>
            <?php echo $this->getIsPublicHtml()?>
        </li>
    </ul>
</div>
<?php
    $attributeGroups = $this->getAttributeGroups();
    $fieldsets = $this->getGroupedRegistryAttributes();
        foreach ($fieldsets as $fieldset => $fields) : ?>

<div class="fieldset">
    <h2> <?php echo $this->getGroupLabel($fieldset);//$attributeGroups[$fieldset]['label'];?></h2>
    <ul class="form-list">

        <?php foreach ($fields as $field => $data) : ?>
        <li>
             <label for="<?php echo $this->wrapId($field) ?>" class="required"><?php echo $this->__($data['label']) ?></label>
             <?php echo $this->renderField($data, $field, $this->wrapId($field), null, '')?>
        </li>
        <?php endforeach; ?>

    </ul>
</div>

<?php   endforeach; ?>

<script type="text/javascript">
//<![CDATA[

<?php if ($this->getRegionJsVisible()): ?>
    new RegionUpdater('event_country_code', 'event_region', 'event_region_id', regionJSON , undefined, 'zip');
<?php endif; ?>

document.observe("dom:loaded", function() {
<?php
/* @var $this Enterprise_GiftRegistry_Block_Customer_Edit*/
$staticAttributes = $this->getStaticAttributes();
$registryData = $this->getEntity()->getData();
?>
<?php foreach ($staticAttributes as $field) : ?>
    <?php if (key_exists($field, $registryData)) : ?>
        setFieldById(<?php echo "'$field', '" . $this->htmlEscape($registryData[$field]) . "'"?> );
    <?php endif; ?>
<?php endforeach; ?>
<?php
$customAttributes = (!empty($registryData['custom_values']) && is_array($registryData['custom_values']))
    ? $registryData['custom_values'] : array();
?>
<?php foreach ($customAttributes as $field => $value) : ?>
    setFieldById(<?php echo "'registry:$field', '" . $this->htmlEscape($value) . "'"?>);
<?php endforeach; ?>

});
//]]>
</script>
