<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2004-2007 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
?>
<?
/**
 * Shoping cart sidebar
 *
 * @see Mage_Checkout_Block_Cart_Sidebar
 */
?>
<?if($this->getCanDisplayCart()):?>
<div class="box base-mini mini-cart">
    <div class="head">
        <?$_cartQty = $this->helper('checkout/cart')->getSummaryCount()*1?>
        <h4><?=$this->__('My Cart')?></h4>
        <?if ($_cartQty>0):?>
           <?if ($_cartQty==1):?><?=$this->__('There is <a href="%s"><strong>1 item</strong></a> your the cart.', $this->getUrl('checkout/cart'))?><?else:?><?=$this->__('There are <a href="%s"><strong>%s items</strong></a> in your cart.', $this->getUrl('checkout/cart'), $_cartQty)?><?endif?>
           <p class="subtotal"><?=$this->__('Cart Subtotal:')?> <strong><?=Mage::helper('core')->currency($this->getSubtotal())?></strong></p><?endif?>
    </div>
            <?$_items = $this->getItems()?>
            <?if(count($_items)):?>
            <div class="actions">
                <button class="form-button" type="button" onclick="setLocation('<?=$this->getUrl('checkout/onepage')?>')"><span><?=$this->__('Checkout')?></span></button>
            </div>
             <?endif?>
    <?if(count($_items)):?>
    <h5>Recently added item(s)</h5>
    <ol id="cart-sidebar">
    <?
        usort($_items, array($this, 'sortByCreatedAt'));
        $_i = 0;
        foreach($_items as $_item):
            if (++$_i==3) break;
            $_itemProduct            = $this->helper('checkout')->getQuoteItemProduct($_item);
            $_productUrl             = $this->helper('checkout')->getQuoteItemProductUrl($_item);
            $_productName            = $this->helper('checkout')->getQuoteItemProductName($_item);
            $_productNameDescription = $this->helper('catalog/product')->getProductDescription($_item);
    ?>
        <li>
            <div class="product-images">
                <a href="<?=$_productUrl?>"><img src="<?=$this->helper('catalog/image')->init($_itemProduct, 'thumbnail')->resize(50, 50)->setWatermarkSize('30x10');?>" alt="<?=$_productName?>" width="50" height="50" /></a>
            </div>
            <div class="product-details">
                <a href="<?=$this->getRemoveItemUrl($_item)?>" onclick="return confirm('<?=$this->__('Are you sure you would like to remove this item from the shopping cart?')?>');" class="widget-btn"><img src="<?=$this->getSkinUrl('images/list_remove_btn.gif')?>" alt="<?=$this->__('Remove Product')?>"/></a>
                <a href="<?=$_productUrl?>"><?=$_productName?></a>
                <?=$_productNameDescription?>
                <br/><strong><?=1*$_item->getQty()?></strong> x <?=Mage::helper('core')->currency($_item->getPrice())?>
            </div>
        </li>
    <?endforeach;?>
    </ol>
    <script type="text/javascript">decorateList('cart-sidebar')</script>
    <?else:?>
    <div class="content"><p><?=$this->__('You have no items in your cart.')?></p></div>
    <?endif?>
</div>
<!-- [ends] .cart-sidebar // -->
<?endif?>
