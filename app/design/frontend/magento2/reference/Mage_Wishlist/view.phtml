<?php
/**
 * {license_notice}
 *
 * @category    design
 * @package     magento2_reference
 * @copyright   {copyright}
 * @license     {license_link}
 */
/* @var $this Mage_Wishlist_Block_Customer_Wishlist */
?>
<?php if ($this->helper('Mage_Wishlist_Helper_Data')->isAllow()) : ?>
    <?php if ($this->helper('Mage_Wishlist_Helper_Data')->isRssAllow() && $this->hasWishlistItems()): ?>
        <a href="<?php echo $this->helper('Mage_Wishlist_Helper_Data')->getRssUrl($this->getWishlistInstance()->getId()); ?>" class="action rss wishlist"><span><?php echo $this->__('RSS Feed') ?></span></a>
    <?php endif; ?>
    <form class="form wishlist items" id="wishlist-view-form" action="<?php echo $this->getUrl('*/*/update', array('wishlist_id' => $this->getWishlistInstance()->getId())) ?>" method="post">
        <?php echo $this->getChildHtml('top'); ?>
        <?php if ($this->hasWishlistItems()): ?>
                <?php echo $this->getBlockHtml('formkey');?>
                <?php $this->getChildBlock('items')->setItems($this->getWishlistItems()); ?>
                <?php echo $this->getChildHtml('items');?>
        <?php else: ?>
            <p class="empty"><?php echo $this->__('You have no items in your wish list.') ?></p>
        <?php endif ?>
        <?php echo $this->getChildHtml('bottom'); ?>
        <div class="actions">
            <div class="primary"><?php echo $this->getChildHtml('control_buttons');?></div>
            <div class="secondary"><a href="<?php echo $this->escapeUrl($this->getBackUrl()) ?>" class="action back"><span><?php echo $this->__('Back') ?></span></a></div>
        </div>
    </form>
    <script id="form-tmpl" type="text/x-jQuery-tmpl">
        <form id="wishlist-hidden-form" method="post" action="${url}" class="no-display">
            {{if itemId}}<input name="item_id" value="${itemId}"/>{{/if}}
            {{if wishlistId}}<input name="wishlist_id" value="${wishlistId}"/>{{/if}}
            {{if qty}}<input name="qty" value="${qty}"/>{{/if}}
            {{if item}}<input name="item" value="${item}"/>{{/if}}
            {{if entity}}<input name="entity" value="${entity}"/>{{/if}}
        </form>
    </script>
    <script>
        (function($) {
            head.js("<?php echo $this->getViewFileUrl('jquery/jquery.validate.js')?>",
                "<?php echo $this->getViewFileUrl('jquery/jquery.metadata.js')?>",
                "<?php echo $this->getViewFileUrl('mage/validation.js')?>",
                "<?php echo $this->getViewFileUrl('mage/validation/validation.js')?>",
                "<?php echo $this->getViewFileUrl('Mage_Persistent::splitbutton.js') ?>",
                "<?php echo $this->getViewFileUrl('Mage_Wishlist::wishlist.js')?>", function() {
                    $('#wishlist-view-form').wishlist({
                        dataAttribute: 'item-id',
                        nameFormat: 'qty[{0}]',
                        btnRemoveSelector: '.action.delete',
                        qtySelector: '.qty',
                        addToCartSelector: '.action.tocart',
                        addAllToCartSelector: '.primary > .action.tocart',
                        commentInputType: 'textarea',
                        infoList: false,
                        addToCartUrl: '<?php echo $this->getItemAddToCartUrl('%item%');?>' ,
                        confirmRemoveMessage: '<?php echo $this->__('Are you sure you want to remove this product from your wishlist?') ?>',
                        addAllToCartUrl : '<?php echo $this->getUrl('*/*/allcart', array('wishlist_id' => $this->getWishlistInstance()->getId())) ?>',
                        commentString : ''
                    });
                    $('body').splitButton();
                });
        })(jQuery);
    </script>
<?php endif ?>
