<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    Enterprise
 * @package     Enterprise_ImportExport
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<layout>
    <adminhtml_scheduled_operation_getfilter>
        <container name="root" label="Root" output="1">
            <block type="Enterprise_ImportExport_Block_Adminhtml_Export_Filter" name="export.filter"/>
            <block type="Mage_Adminhtml_Block_Template"
                   template="Mage_ImportExport::export/form/filter/after.phtml"
                   name="export.form.after" alias="form_after"/>
        </container>
    </adminhtml_scheduled_operation_getfilter>
    <adminhtml_scheduled_operation_index>
        <update handle="formkey" />
        <update handle="adminhtml_scheduled_operation_block" />
        <reference name="content">
            <block type="Enterprise_ImportExport_Block_Adminhtml_Scheduled_Operation" name="adminhtml.block.scheduled.operation.grid.container"/>
        </reference>
    </adminhtml_scheduled_operation_index>
    <adminhtml_scheduled_operation_grid>
        <update handle="formkey"/>
        <update handle="adminhtml_scheduled_operation_block"/>
        <container label="Scheduled Imports/Exports" name="adminhtml.block.scheduled.operation.grid.container" output="1"/>
    </adminhtml_scheduled_operation_grid>
    <adminhtml_scheduled_operation_block>
        <reference name="adminhtml.block.scheduled.operation.grid.container">
            <block type="Mage_Backend_Block_Widget_Grid" name="adminhtml.block.scheduled.operation.grid" as="grid">
                <arguments>
                    <id>operationGrid</id>
                    <dataSource type="object">Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Collection
                    </dataSource>
                    <use_ajax>1</use_ajax>
                    <default_sort>id</default_sort>
                    <default_dir>DESC</default_dir>
                    <grid_url type="url">
                        <path>*/*/grid</path>
                        <params>
                            <_current>1</_current>
                        </params>
                    </grid_url>
                </arguments>
                <block type="Mage_Backend_Block_Widget_Grid_Massaction"
                       name="adminhtml.block.scheduled.operation.massactions" as="grid.massaction">
                    <arguments>
                        <massaction_id_field>id</massaction_id_field>
                        <form_field_name>operation</form_field_name>
                        <use_select_all>1</use_select_all>
                        <options>
                            <delete>
                                <label translate="true" module="Enterprise_ImportExport">Delete</label>
                                <url>*/*/massDelete</url>
                                <confirm translate="true" module="Enterprise_ImportExport">Are you sure you want to
                                    delete the selected scheduled imports/exports?
                                </confirm>
                            </delete>
                            <status>
                                <label translate="true" module="Enterprise_ImportExport">Change status</label>
                                <url>*/*/massChangeStatus</url>
                                <block_name>status</block_name>
                            </status>
                        </options>
                    </arguments>
                    <block type="Mage_Backend_Block_Widget_Grid_Massaction_Additional"
                           name="adminhtml.block.scheduled.operation.massactions.status" as="status">
                        <arguments>
                            <fields>
                                <visibility>
                                    <name>status</name>
                                    <type>select</type>
                                    <class>required-entry</class>
                                    <label translate="true" module="Enterprise_ImportExport">Status</label>
                                    <values>
                                        Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Statuses
                                    </values>
                                </visibility>
                            </fields>
                        </arguments>
                    </block>
                </block>
                <block type="Mage_Backend_Block_Widget_Grid_ColumnSet" as="grid.columnSet">
                    <arguments>
                        <id>operationGrid</id>
                        <rowUrl>
                            <path>*/*/edit</path>
                            <extraParamsTemplate>
                                <id>getId</id>
                            </extraParamsTemplate>
                        </rowUrl>
                    </arguments>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="name">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Name</header>
                            <index>name</index>
                            <type>text</type>
                            <escape>1</escape>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="operation_type">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Operation</header>
                            <index>operation_type</index>
                            <type>options</type>
                            <width>30</width>
                            <options type='options'>
                                Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Operations
                            </options>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="entity_type">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Entity Type</header>
                            <index>entity_type</index>
                            <type>options</type>
                            <options type='options'>
                                Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Entities
                            </options>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="last_run_date">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Last Run</header>
                            <index>last_run_date</index>
                            <type>datetime</type>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="freq">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Frequency</header>
                            <index>freq</index>
                            <type>options</type>
                            <options type='options'>
                                Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Frequency
                            </options>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="status">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Status</header>
                            <index>status</index>
                            <type>options</type>
                            <options type='options'>
                                Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Statuses
                            </options>
                        </arguments>
                    </block>
                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="is_success">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Last Outcome</header>
                            <index>is_success</index>
                            <type>options</type>
                            <width>200</width>
                            <options type='options'>
                                Enterprise_ImportExport_Model_Resource_Scheduled_Operation_Options_Result
                            </options>
                        </arguments>
                    </block>

                    <block type="Mage_Backend_Block_Widget_Grid_Column" as="action">
                        <arguments>
                            <header translate="true" module="Enterprise_ImportExport">Action</header>
                            <index>id</index>
                            <width>50</width>
                            <type>action</type>
                            <getter>getId</getter>
                            <filter>0</filter>
                            <sortable>0</sortable>
                            <actions>
                                <edit_action>
                                    <caption translate="true" module="Enterprise_ImportExport">Edit</caption>
                                    <url>
                                        <base>*/*/edit</base>
                                    </url>
                                    <field>id</field>
                                </edit_action>
                                <run_action>
                                    <caption translate="true" module="Enterprise_ImportExport">Run</caption>
                                    <url>
                                        <base>*/scheduled_operation/cron</base>
                                    </url>
                                    <field>operation</field>
                                </run_action>
                            </actions>
                        </arguments>
                    </block>
                </block>
            </block>
        </reference>
    </adminhtml_scheduled_operation_block>
    <adminhtml_scheduled_operation_new>
        <update handle="adminhtml_scheduled_operation_edit" />
    </adminhtml_scheduled_operation_new>
    <adminhtml_scheduled_operation_edit>
        <reference name="content">
            <block type="Mage_ImportExport_Block_Adminhtml_Import_Edit_Before"
                   template="Enterprise_ImportExport::scheduled/form/before.phtml"
                   name="export.form.before" alias="form_before"/>
            <block type="Enterprise_ImportExport_Block_Adminhtml_Scheduled_Operation_Edit" name="operation.edit" />
            <block type="Mage_Adminhtml_Block_Template" template="Enterprise_ImportExport::scheduled/form/after.phtml"
                   name="operation.form.after" />
            <block type="Mage_Adminhtml_Block_Template" template="Mage_ImportExport::export/form/filter/after.phtml"
                   name="export.form.after" alias="form_after"/>
        </reference>
    </adminhtml_scheduled_operation_edit>
</layout>
