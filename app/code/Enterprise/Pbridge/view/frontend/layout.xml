<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<layout version="0.1.0">

    <checkout_onepage_index>
        <reference name="content">
            <block type="Mage_Core_Block_Template" name="pbridge.js" template="Enterprise_Pbridge::checkout/payment/js.phtml" />
        </reference>
        <reference name="head">
            <action method="addJs"><file>Enterprise_Pbridge::js/pbridge.js</file></action>
        </reference>
    </checkout_onepage_index>

    <checkout_onepage_paymentmethod>
        <reference name="checkout.onepage.payment.methods.scripts">
            <block type="Mage_Core_Block_Template" template="Enterprise_Pbridge::checkout/payment/scripts.phtml" name="pbridge.scripts" />
        </reference>
    </checkout_onepage_paymentmethod>

    <checkout_multishipping_billing>
        <reference name="content">
            <block type="Mage_Core_Block_Template" name="pbridge.js" template="Enterprise_Pbridge::checkout/payment/js.phtml" />
        </reference>
    </checkout_multishipping_billing>

    <enterprise_pbridge_pbridge_result translate="label" type="fragment" owner="checkout_onepage_index">
        <label>Payment Bridge Checkout Payment Result</label>
        <block type="Mage_Page_Block_Html" name="root" output="1" template="page_fragment.phtml">
            <block type="Enterprise_Pbridge_Block_Checkout_Payment_Result" name="pbridge.checkout.payment.result" template="checkout/payment/result.phtml" />
        </block>
    </enterprise_pbridge_pbridge_result>

    <enterprise_pbridge_payment_profile_index translate="label" type="page">
        <label>Payment Bridge Frame with Saved Payment Profiles</label>
        <update handle="customer_account" />
        <reference name="my.account.wrapper">
            <block type="Enterprise_Pbridge_Block_Payment_Profile" name="pbridge.payment.profile" template="payment/profile.phtml" />
        </reference>
    </enterprise_pbridge_payment_profile_index>

    <customer_account>
        <reference name="customer_account_navigation">
            <action method="addLink" translate="label" module="Enterprise_Pbridge" ifconfig="payment/pbridge/profilestatus"><name>pbridge_payment_profile</name><path>enterprise_pbridge/payment_profile/</path><label>My Credit Cards</label></action>
        </reference>
    </customer_account>

    <checkout_onepage_review>
        <reference name="checkout.onepage.review.button">
            <action method="setTemplate"><template helper="Enterprise_Pbridge_Helper_Data::getReviewButtonTemplate"><name>Enterprise_Pbridge::checkout/review/button.phtml</name><block>checkout.onepage.review.button</block></template></action>
        </reference>
        <reference name="checkout.onepage.review.info.items.after">
            <block type="Enterprise_Pbridge_Block_Checkout_Payment_Review_Container" name="pbridge.checkout.payment.review.iframe" template="Enterprise_Pbridge::checkout/review/iframe.phtml" />
        </reference>
    </checkout_onepage_review>

    <enterprise_pbridge_pbridge_success>
        <block type="Mage_Core_Block_Template" name="pbridge.checkout.review.success" template="Enterprise_Pbridge::checkout/review/success.phtml" output="1" />
    </enterprise_pbridge_pbridge_success>

    <enterprise_pbridge_pbridge_error>
        <block type="Mage_Core_Block_Template" name="pbridge.checkout.review.error" template="Enterprise_Pbridge::checkout/review/error.phtml" output="1" />
    </enterprise_pbridge_pbridge_error>
</layout>
