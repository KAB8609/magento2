<?php
/**
 * {license_notice}
 *
 * @category    Mage
 * @package     Mage_Launcher
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Launcher_Block_Adminhtml_Storelauncher_Tax_Drawer */
?>
<form action="" id="drawer-form" method="post">
    <?php echo $this->getBlockHtml('formkey')?>

    <div onselectstart="return false;" class="switcher drawer-switcher" id="field-no-tax">
        <label for="tax-enabled" class="switcher-label">
            <strong>
                <em class="label-tax-enabled"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Tax rules enabled') ?></em>
                <em class="label-tax-disabled hidden"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Tax rules disabled') ?></em>
            </strong>
            <input id="tax-enabled" name="use_tax" type="checkbox" checked="checked" value="tax-enabled">
            <span></span>
        </label>
    </div>

    <div class="tax-rule-config">
        <h2 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Manage Tax Rules') ?></h2>
        <div class="tax-rule-info">
            <?php echo $this->getChildHtml('tax-rule-edit');?>
            <?php echo $this->getChildBlock('tax-rule-form')->setUseContainer(false)->toHtml();?>
        </div>

        <?php echo $this->getChildBlock('tax-rate-importExport')->setUseContainer(false)->toHtml();?>

    </div>

    <div class="no-tax-info hidden">
        <h2 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('You have disabled Tax Rules') ?></h2>
        <p><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('You can always choose to enable Tax Rates again if you disabled it by mistake.') ?></p>
        <p><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Consult your local laws regarding taxes. We can recommend tax rates based on your business location if you are in the US.') ?></p>
    </div>

</form>

<?php echo $this->getChildHtml('tax-rate-form'); ?>

<script type="text/javascript">
    (function ($) {
        $(document).ready(function () {
            'use strict';
            var drawerForm = $('#drawer-form'),
                taxRuleConfig = $('.tax-rule-config'),
                noTaxInfo = $('.no-tax-info'),
                taxEnabled = '.label-tax-enabled',
                taxDisabled = '.label-tax-disabled';


            $('#tax-enabled').on('change.use_tax', function () {
                var elem = $(this);

                if (elem.is(':checked')) {
                    drawerForm.removeClass('ignore-validate');
                    taxRuleConfig
                        .add(taxEnabled)
                        .removeClass('hidden');
                    noTaxInfo
                        .add(taxDisabled)
                        .addClass('hidden');

                } else {
                    drawerForm.addClass('ignore-validate');
                    taxRuleConfig
                        .add(taxEnabled)
                        .addClass('hidden');
                    noTaxInfo
                        .add(taxDisabled)
                        .removeClass('hidden');
                }
            });
        });
    })(window.jQuery);
</script>
