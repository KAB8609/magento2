<?php
/**
 * {license_notice}
 *
 * @category    Mage
 * @package     Mage_Launcher
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Launcher_Block_Adminhtml_Storelauncher_Shipping_Drawer_OriginAddress */
?>
<h1><?php echo $this->helper('Mage_Launcher_Helper_Data')->__('Your Business Address'); ?></h1>
<div class="entry-edit">
    <?php echo $this->getFormHtml(); ?>
</div>
<?php echo $this->getChildHtml('form_after'); ?>
<button class="button button-original-address"
    data-save-url="<?php echo $this->getUrl('*/storelauncher_shipping_drawer/saveOriginAddress') ?>">
    <?php echo $this->helper('Mage_Launcher_Helper_Data')->__('Save'); ?>
</button>
<script type="text/javascript">
    (function ($) {
        $('.button-original-address').on('click', function (event) {
            event.preventDefault();
            var drawerForm = $('#drawer-form').validation();

            if (!drawerForm.valid()) {
                return false;
            }

            $.ajax({
                type: 'POST',
                data: drawerForm.serializeArray(),
                dataType: 'json',
                url: $(this).attr('data-save-url')
            }).success(function(result, status) {
                if (result && result.error_message) {
                    alert(result.error_message);
                }
            });
        });

    })(window.jQuery);
</script>