<?php
/**
 * {license_notice}
 *
 * @category    Mage
 * @package     Mage_Launcher
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Launcher_Block_Adminhtml_Storelauncher_Design_Drawer */
?>
<form action="" id="drawer-form" method="post">
<div class="themes-list-wrapper">
<?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('First choose a store theme, then customize it for your business') ?>

<ul class="themes-list">
    <?php foreach ($this->getThemesBlocks() as $theme):?>
        <?php echo $theme->toHtml() ?>
    <?php endforeach; ?>
</ul>

</div>

<div class="theme-page hidden">
    <input type="hidden" name="groups[design][theme][fields][theme_id][value]" id="theme-id" value="<?php echo $this->getConfigValue('design/theme/theme_id'); ?>">
    <h2><?php echo $this->__('You\'ve created your store theme, name, and logo'); ?></h2>
    <dl class="theme-selected-thumbnail">
        <dt>
            <?php echo $this->__('Your Theme'); ?> <a href="#" class="button btn-edit edit-theme" id="edit-theme"><?php echo $this->__('Edit'); ?></a>
        </dt>
        <dd>
            <img src="<?php echo $this->getCurrentTheme()->getPreviewImageUrl() ?>" id="theme-image">
        </dd>
    </dl>
    <dl class="theme-selected-info">
        <dt><?php echo $this->__('Store Name'); ?></dt>
        <dd class="theme-selected-name">
            <div id="field-store-name-1" >
                <input type="text" id="store-name-1" name="store_information" value="<?php echo $this->getConfigValue('general/store_information/name'); ?>" class="input-text">
            </div>
        </dd>
    </dl>
</div>
</form>

<?php echo $this->getChildHtml('store_design.widget'); ?>
<script type="text/javascript">
    (function($) {
        $(document).ready(function() {
            'use strict';
            var currentThemeId = <?php echo $this->getCurrentThemeId() ? $this->getCurrentThemeId() : 'null'; ?>;
            $('#drawer')
                .drawerPages()
                .drawerPages('headerButtonCreate', {
                    name: 'skip',
                    id: 'button_skip',
                    title: '<?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Skip This for Now'); ?>',
                    click: function() {
                        $('#drawer').drawerPages('drawerPageSwitch', 'theme-page');
                    },
                    afterShow: function() {
                        if (!currentThemeId) {
                            $(this).addClass('hidden');
                        }
                    }
                })
                .drawerPages('drawerPageAdd', {
                    name: 'themes-list',
                    page: '.themes-list-wrapper',
                    buttons: ['skip', 'close']
                })
                .drawerPages('drawerPageAdd', {
                    name: 'theme-page',
                    page: '.theme-page',
                    buttons: ['save', 'close']
                })
                .drawerPages('drawerPageSwitch', currentThemeId ? 'theme-page' : 'themes-list')
            ;
            $('.edit-theme')
                .on('click', function() {
                    $('#drawer').drawerPages('drawerPageSwitch', 'themes-list');
                    return false;
                });
            $('.btn-theme-choose')
                .on('click', function(event) {
                    event.preventDefault();
                    $('#drawer').drawerPages('drawerPageSwitch', 'theme-page');
                    $('#theme-image').attr('src' , $(this).attr('data-theme-img-src'));
                    $('#theme-id').val($(this).attr('data-theme-id'));
                    return false;
                });
        });
    })(jQuery);
</script>
