<?php
/**
 * {license_notice}
 *
 * @category    design
 * @package     default_default
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Catalog_Block_Product_Configurable_AttributeSelector */
?>
<script id="configurable-attribute-selector-template" type="text/x-jquery-tmpl">
    <ul data-mage-init="{menu:[]}">
        {{each items}}
        <li {{html optionData($value)}}><a href="#">${$value.label}</a></li>
        {{/each}}
    </ul>
</script>
<script type="text/javascript">
jQuery(function($) {
    var options = <?php echo $this->helper('Mage_Core_Helper_Data')->jsonEncode($this->getSuggestWidgetOptions())?>;
    $.extend(options, {
        response: function(data) {
            var list = [];
            $.each(data, function(id, item) {
                if (!$('#configurable_attribute_' + id ).length) {
                    list.push(item);
                }
            });
            return list;
        }
    });

    $('#configurable-attribute-selector')
        .suggest(options)
        .on('suggestselect', function (event, selectedItem) {
            if (selectedItem.id) {
                $('#configurable-attributes-container').trigger('add', selectedItem);
            }
            $(this).val('');
            return false;
        });
});
</script>
