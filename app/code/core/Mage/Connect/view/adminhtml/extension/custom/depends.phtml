<?php
/**
 * {license_notice}
 *
 * @category    design
 * @package     default_default
 * @copyright   {copyright}
 * @license     {license_link}
 */
?>

<?php echo $this->getFormHtml() ?>

<fieldset id="depends_packages_fieldset" class="fieldset grid">
    <legend class="legend"><span><?php echo $this->__("Packages") ?></span></legend>
    <table class="data" cellspacing="0">
        <thead>
            <tr class="headings">
                <th><span><?php echo $this->__("Package") ?></span></th>
                <th><span><?php echo $this->__("Channel") ?></span></th>
                <th><span><?php echo $this->__("Min") ?></span></th>
                <th><span><?php echo $this->__("Max") ?></span></th>
                <th><span><?php echo $this->__("Files") ?></span></th>
                <th><span><?php echo $this->__("Action") ?></span></th>
            </tr>
            <tr id="depends_packages_template" style="display:none">
            <?php function showDependsPackageTemplate($self, $_i = 0)
            {
                $filesClass = "files";
            ?>
                <td>
                    <input class="input-text" name="depends[package][name][]"  value="<?php echo $self->getValue('depends/package/name/' . $_i) ?>"/>
                </td>
                <td>
                    <input class="input-text" name="depends[package][channel][]" value="<?php echo $self->getValue('depends/package/channel/' . $_i) ?>"/>
                </td>
                <td>
                    <input class="input-text" name="depends[package][min][]" value="<?php echo $self->getValue('depends/package/min/' . $_i) ?>"/>
                </td>
                <td>
                    <input class="input-text" name="depends[package][max][]" value="<?php echo $self->getValue('depends/package/max/' . $_i) ?>"/>
                </td>
                <td>
                    <textarea class="<?php echo $filesClass ?>" style="display:none" name="depends[package][files][]"><?php echo $self->getValue('depends/package/files/' . $_i)?> </textarea>
                    <?php echo $self->getAddFileDepsRowButtonHtml("tr", $filesClass) ?>
                </td>
                <td>
                    <?php echo $self->getRemoveRowButtonHtml('tr') ?>
                </td>
            <?php } ?>
            <?php showDependsPackageTemplate($this) ?>
            </tr>
        </thead>
        <tbody id="depends_packages_container">
        <?php if ($this->getData('depends/package/name')): ?>
            <?php foreach ($this->getData('depends/package/name') as $_i => $_dbField): ?>
                <?php if (0 === $_i) continue; ?>
                <tr>
                    <?php showDependsPackageTemplate($this, $_i) ?>
                </tr>
            <?php endforeach ?>
        <?php endif ?>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="8"><?php echo $this->getAddRowButtonHtml('depends_packages_container', 'depends_packages_template', $this->__('Add Package dependency')) ?></td>
            </tr>
        </tfoot>
    </table>
</fieldset>

<fieldset id="depends_extensions_fieldset" class="fieldset grid">
    <legend class="legend"><span><?php echo $this->__("Extensions") ?></span></legend>
    <table class="data" cellspacing="0">
        <thead>
            <tr class="headings">
                <th><span><?php echo $this->__("Extension") ?></span></th>
                <th><span><?php echo $this->__("Min") ?></span></th>
                <th><span><?php echo $this->__("Max") ?></span></th>
                <th><span><?php echo $this->__("Action") ?></span></th>
            </tr>
            <tr id="depends_extensions_template" style="display:none">
            <?php function showDependsExtensionsTemplate($self, $_i=0) { ?>
                <td>
                    <select name="depends[extension][name][]" style="width:100px">
                        <?php foreach ($self->getExtensions() as $_value => $_label): ?>
                        <option value="<?php echo $_value ?>" <?php echo $self->getSelected('depends/extension/name/' . $_i, $_value) ?>><?php echo $_label ?></option>
                        <?php endforeach ?>
                    </select>
                </td>
                <td>
                    <input class="input-text" name="depends[extension][min][]" value="<?php echo $self->getValue('depends/extension/min/' . $_i) ?>"/>
                </td>
                <td>
                    <input class="input-text" name="depends[extension][max][]" value="<?php echo $self->getValue('depends/extension/max/' . $_i) ?>"/>
                </td>
                <td>
                    <?php echo $self->getRemoveRowButtonHtml('tr') ?>
                </td>
            <?php } ?>
            <?php showDependsExtensionsTemplate($this) ?>
            </tr>
        </thead>
        <tbody id="depends_extensions_container">
        <?php if ($this->getData('depends/extension/name')): ?>
            <?php foreach ($this->getData('depends/extension/name') as $_i=>$_dbField): ?>
                <?php if (0===$_i) continue; ?>
                <tr>
                    <?php showDependsExtensionsTemplate($this, $_i) ?>
                </tr>
            <?php endforeach ?>
        <?php endif ?>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="7"><?php echo $this->getAddRowButtonHtml('depends_extensions_container', 'depends_extensions_template', $this->__('Add PHP Extension dependency')) ?></td>
            </tr>
        </tfoot>
    </table>
</fieldset>
