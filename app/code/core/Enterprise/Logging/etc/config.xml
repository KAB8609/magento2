<?xml version="1.0"?>
<!--
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   Enterprise
 * @package    Enterprise_Permissions
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
-->
<config>
    <modules>
        <Enterprise_Logging>
             <version>0.0.1</version>
        </Enterprise_Logging>
    </modules>
    <global>
        <models>
          <logging_mysql4>
            <class>Enterprise_Logging_Model_Mysql4</class>
            <entities>
              <user_log>
                <table>enterprise_user_log</table>
              </user_log>
            </entities>
          </logging_mysql4>
          <logging>
                <class>Enterprise_Logging_Model</class>
                <resourceModel>logging_mysql4</resourceModel>
          </logging>
        </models>
        <blocks>
          <logging>
            <class>Enterprise_Logging_Block</class>
          </logging>
        </blocks>
        <helpers>
          <logging>
            <class>Enterprise_Logging_Helper</class>
          </logging>
        </helpers>
        <resources>
            <logging_setup>
                <setup>
                    <module>Enterprise_Logging</module>
                    <class>Mage_Eav_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </logging_setup>
            <logging_write>
              <connection>
                <use>core_write</use>
              </connection>
            </logging_write>
            <logging_read>
              <connection>
                <use>core_read</use>
              </connection>
            </logging_read>
        </resources>
    </global>
    <adminhtml>
        <events>
            <on_product_view_after>
                <observers>
                    <enterprise_logging>
                        <type>singleton</type>
                        <class>logging/observer</class>
                        <method>addEventAfterProductView</method>
                    </enterprise_logging>
                </observers>
            </on_product_view_after>
            
            <on_admin_login_after>
                <observers>
                    <enterprise_logging>
                        <type>singleton</type>
                        <class>logging/observer</class>
                        <method>addEventAfterLogin</method>
                    </enterprise_logging>
                </observers>
            </on_admin_login_after>

            <on_product_save>
                <observers>
                    <enterprise_logging>
                        <type>singleton</type>
                        <class>logging/observer</class>
                        <method>addEventOnProductSave</method>
                    </enterprise_logging>
                </observers>
            </on_product_save>

            <on_product_delete>
                <observers>
                    <enterprise_logging>
                        <type>singleton</type>
                        <class>logging/observer</class>
                        <method>addEventOnProductDelete</method>
                    </enterprise_logging>
                </observers>
            </on_product_delete>

        </events>
        <menu>
          <system>
            <children>
              <enterprise translate="title">
                 <title>Admin Logging</title>
                 <sort_order>21</sort_order>
                 <children>
                   <logs translate="title">
                     <title>Events</title>
                     <sort_order>10</sort_order>
                     <action>logging/events</action>
                   </logs>
                 </children>
              </enterprise>
            </children>
          </system>
        </menu>
        <acl>
          <resources>
            <admin>
              <children>
                <system>
                  <children>
                    <config>
                      <children>
                        <logging>
                          <title>Enterprise</title>
                        </logging>
                      </children>
                    </config>
                  </children>
                </system>
              </children>
            </admin>
          </resources>
        </acl>

        <layout>
            <updates>
                <events>
                    <file>enterprise/events.xml</file>
                </events>
            </updates>
        </layout>
    </adminhtml>

    <enterprise>
      <logging>
        <events>
          <products module="Logging" translate="Label">
            <label>Products</label>
            <code>10</code>
            <actions>
              <view>
                <success>Product (sku=%s) viewed successfully</success>
              </view>
              <delete>
                <success>Product (sku=%s) deleted successfully</success>
                <fail>Product (sku=%s) was failed to delete</fail>
              </delete>
              <save>
                <success>Product (sku=%s) saved successfully</success>
                <fail>Product (sku=%s) was failed to save</fail>
              </save>
            </actions>
          </products>

          <categories module="Logging" translate="Label">
            <label>Categories</label>
            <code>20</code>
            <actions>
              <view>
                <success>"Category (%s) viewd successfully"</success>
              </view>
              <delete>
                <success>"Category (%s) deleted successfully"</success>
                <fail>"Category (%s) was failed to delete"</fail>
              </delete>
              <save>
                <success>"Category (%s) saved successfully"</success>
                <fail>"Category (%s) was failed to save"</fail>
              </save>
              <save>
                <success>"Category (%s) moved successfully"</success>
                <fail>"Category (%s) was failed to move"</fail>
              </save>
            </actions>
          </categories>

          <customers module="Logging" translate="Label">
            <label>Customers</label>
            <code>30</code>
            <actions>
            </actions>
          </customers>

          <cmspages module="Logging" translate="Label">
            <label>Cms Pages</label>
            <code>40</code>
            <actions>
              <view />
              <delete />
              <save />
            </actions>
          </cmspages>

          <cmsblocks module="Logging" translate="Label">
            <label>Cms Blocks</label>
            <code>50</code>
            <actions>
              <view />
              <delete />
              <save />
            </actions>
          </cmsblocks>

          <adminlogin module="Logging" translate="Label">
            <label>Admin Login</label>
            <code>60</code>
            <actions>
              <view />
              <delete />
              <save />
            </actions>
          </adminlogin>

          <systemconfiguration module="Logging" translate="Label">
            <label>System Configuration</label>
            <code>70</code>
            <actions>
              <view />
              <delete />
              <save />
            </actions>
          </systemconfiguration>

          <reports module="Logging" translate="Label">
            <label>Reports</label>
            <code>80</code>
            <actions>
              <view />
              <delete />
              <save />
            </actions>
          </reports>

        </events>
      </logging>
    </enterprise>

    <admin>
        <routers>
            <logging>
                <use>admin</use>
                <args>
                  <modules>
                    <logging>Enterprise_Logging</logging>
                  </modules>
                  <frontName>logging</frontName>
                </args>
            </logging>
        </routers>
        <menu>
          <system>
            <children>
              <logging translate="title">
                 <title>Admin Logging</title>
                 <sort_order>21</sort_order>
                 <children>
                   <logs translate="title">
                     <title>Events</title>
                     <sort_order>10</sort_order>
                     <action>logging/events</action>
                   </logs>
                 </children>
              </logging>
            </children>
          </system>
        </menu>
        <acl>
          <resources>
            <admin>
                <system>
                    <config>
                        <logging />
                    </config>
                </system>
            </admin>
          </resources>
        </acl>

    </admin>

    <default>
      <logging>
        <enabled>
          <products>1</products>
          <categories>0</categories>
          <adminlogin>1</adminlogin>
        </enabled>
      </logging>
    </default>
</config>
