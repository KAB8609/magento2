<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    design
 * @package     default_default
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->

<layout>
    <adminhtml_banner_index>
        <reference name="content">
            <block type="Enterprise_Banner_Block_Adminhtml_Banner" name="banner_list"/>
        </reference>
    </adminhtml_banner_index>
    <adminhtml_banner_edit>
        <update handle="editor"/>
        <reference name="head">
            <action method="addCss"><file>Mage_Adminhtml::jquery/fileUploader/css/jquery.fileupload-ui.css</file></action>

            <action method="addJs"><file>Mage_Adminhtml::jquery/fileUploader/jquery.iframe-transport.js</file></action>
            <action method="addJs"><file>Mage_Adminhtml::jquery/fileUploader/jquery.fileupload.js</file></action>

            <action method="addJs"><file>Mage_Adminhtml::jquery/fileUploader/load-image.min.js</file></action>
            <action method="addJs"><file>Mage_Adminhtml::jquery/fileUploader/canvas-to-blob.min.js</file></action>
            <action method="addJs"><file>Mage_Adminhtml::jquery/fileUploader/jquery.fileupload-fp.js</file></action>
        </reference>
        <reference name="left">
            <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tabs" name="banner_edit_tabs">
                <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Properties" name="banner_edit_tab_properties"/>
                <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Content" name="banner_edit_tab_content"/>
                <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Promotions" name="banner_edit_tab_promotions" template="edit/tab/promotions.phtml">
                    <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Promotions_Salesrule" name="banner_salesrule_grid"/>
                    <block type="Mage_Adminhtml_Block_Widget_Grid_Serializer" name="salesrule_grid_serializer">
                        <reference name="salesrule_grid_serializer">
                            <action method="initSerializerBlock">
                                <grid_block_name>banner_salesrule_grid</grid_block_name>
                                <data_callback>getRelatedSalesRule</data_callback>
                                <hidden_input_name>banner_sales_rules</hidden_input_name>
                                <reload_param_name>selected_salesrules</reload_param_name>
                            </action>
                        </reference>
                    </block>
                    <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Promotions_Catalogrule" name="banner_catalogrule_grid"/>
                    <block type="Mage_Adminhtml_Block_Widget_Grid_Serializer" name="catalogrule_grid_serializer">
                        <reference name="catalogrule_grid_serializer">
                            <action method="initSerializerBlock">
                                <grid_block_name>banner_catalogrule_grid</grid_block_name>
                                <data_callback>getRelatedCatalogRule</data_callback>
                                <hidden_input_name>banner_catalog_rules</hidden_input_name>
                                <reload_param_name>selected_catalogrules</reload_param_name>
                            </action>
                        </reference>
                    </block>
                </block>
                <action method="addTab"><name>properties_section</name><block>banner_edit_tab_properties</block></action>
                <action method="addTab"><name>content_section</name><block>banner_edit_tab_content</block></action>
                <action method="addTab"><name>promotions_section</name><block>banner_edit_tab_promotions</block></action>
            </block>
        </reference>
        <reference name="content">
            <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit" name="banner_edit_content"/>
        </reference>
    </adminhtml_banner_edit>

    <adminhtml_banner_grid>
        <remove name="root"/>
        <update handle="formkey"/>
        <block type="Enterprise_Banner_Block_Adminhtml_Banner_Grid" name="banner_grid" output="1"/>
    </adminhtml_banner_grid>
    <adminhtml_banner_salesrulegrid>
        <remove name="root"/>
        <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Promotions_Salesrule" name="banner_salesrule_grid" output="1"/>
    </adminhtml_banner_salesrulegrid>
    <adminhtml_banner_catalogrulegrid>
        <remove name="root"/>
        <block type="Enterprise_Banner_Block_Adminhtml_Banner_Edit_Tab_Promotions_Catalogrule" name="banner_catalogrule_grid" output="1"/>
    </adminhtml_banner_catalogrulegrid>

     <!-- Binding Banners Tab for Catalog Price Rule -->
    <adminhtml_promo_catalog_edit>
        <reference name="promo_catalog_edit_tabs">
            <block type="Enterprise_Banner_Block_Adminhtml_Promo_Catalogrule_Edit_Tab_Banners" name="catalogrule.related.banners">
                <block type="Enterprise_Banner_Block_Adminhtml_Promo_Catalogrule_Edit_Tab_Banners_Grid" name="related_catalogrule_banners_grid"/>
                <block type="Mage_Adminhtml_Block_Widget_Grid_Serializer" name="banners_grid_serializer">
                    <reference name="banners_grid_serializer">
                        <action method="initSerializerBlock">
                            <grid_block_name>related_catalogrule_banners_grid</grid_block_name>
                            <data_callback>getRelatedBannersByRule</data_callback>
                            <hidden_input_name>related_banners</hidden_input_name>
                            <reload_param_name>selected_catalogrule_banners</reload_param_name>
                        </action>
                    </reference>
                </block>
            </block>
            <action method="addTab"><name>banners_section</name><block>catalogrule.related.banners</block></action>
            <block type="Enterprise_Banner_Block_Adminhtml_Permission_Monitor" name="bannner.permission.monitor"/>
        </reference>
    </adminhtml_promo_catalog_edit>

    <!-- Binding Banners Grid for Shopping Cart Price Rule -->
    <adminhtml_banner_catalogrulebannersgrid>
        <remove name="root"/>
        <block type="Enterprise_Banner_Block_Adminhtml_Promo_Catalogrule_Edit_Tab_Banners_Grid" name="related_catalogrule_banners_grid" output="1"/>
    </adminhtml_banner_catalogrulebannersgrid>


    <!-- Binding Banners Tab for Shopping Cart Price Rule -->
    <adminhtml_promo_quote_edit>
        <reference name="promo_quote_edit_tabs">
            <block type="Enterprise_Banner_Block_Adminhtml_Promo_Salesrule_Edit_Tab_Banners" name="salesrule.related.banners">
                <block type="Enterprise_Banner_Block_Adminhtml_Promo_Salesrule_Edit_Tab_Banners_Grid" name="related_salesrule_banners_grid"/>
                <block type="Mage_Adminhtml_Block_Widget_Grid_Serializer" name="banners_grid_serializer">
                    <reference name="banners_grid_serializer">
                        <action method="initSerializerBlock">
                            <grid_block_name>related_salesrule_banners_grid</grid_block_name>
                            <data_callback>getRelatedBannersByRule</data_callback>
                            <hidden_input_name>related_banners</hidden_input_name>
                            <reload_param_name>selected_salesrule_banners</reload_param_name>
                        </action>
                    </reference>
                </block>
            </block>
            <action method="addTab"><name>banners_section</name><block>salesrule.related.banners</block></action>
            <block type="Enterprise_Banner_Block_Adminhtml_Permission_Monitor" name="bannner.permission.monitor"/>
        </reference>
    </adminhtml_promo_quote_edit>

    <!-- Binding Banners Grid for Shopping Cart Price Rule -->
    <adminhtml_banner_salesrulebannersgrid>
        <remove name="root"/>
        <block type="Enterprise_Banner_Block_Adminhtml_Promo_Salesrule_Edit_Tab_Banners_Grid" name="related_salesrule_banners_grid" output="1"/>
    </adminhtml_banner_salesrulebannersgrid>
</layout>
