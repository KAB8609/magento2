<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   {copyright}
 * @license     {license_link}
 */

-->
<layout version="0.1.0">
    <customer_logged_in>
        <block type="Enterprise_Invitation_Block_Link" name="invitation_link_top">
            <action method="addAccountLink" translate="label title" module="Enterprise_Invitation"><block>account.links</block><label>Send Invitations</label><url helper="Enterprise_Invitation_Helper_Data::getCustomerInvitationFormUrl" /><title>Send Invitations</title><prepare /><urlParams /><position>1</position><li>id="invitation-send-link"</li></action>
        </block>
    </customer_logged_in>

    <enterprise_invitation_index_send translate="label" type="page">
        <parent_node>enterprise_invitation_index_index</parent_node>
        <label>Customer My Account Invitations Form</label>
        <update handle="customer_account"/>
        <reference name="customer_account_navigation">
            <action method="setActive"><path>enterprise_invitation/index/index</path></action>
        </reference>
        <reference name="my.account.wrapper">
            <block type="Enterprise_Invitation_Block_Form" name="invitationForm" template="Enterprise_Invitation::form.phtml">
                <block type="Mage_Page_Block_Html_Wrapper" name="invitations.form.form.before" as="form_before" translate="label">
                    <label>Invitation Form Before</label>
                    <!--action method="setMayBeInvisible"><value>1</value></action-->
                    <action method="setElementClass"><value>rewards</value></action>
                </block>
            </block>
        </reference>
    </enterprise_invitation_index_send>

    <enterprise_invitation_index_index translate="label" type="page">
        <parent_node>customer_account_index</parent_node>
        <label>Customer My Account Invitations List</label>
        <update handle="customer_account"/>
        <reference name="my.account.wrapper">
            <block type="Enterprise_Invitation_Block_Customer_List" name="invitations_list" template="list.phtml">
                <block type="Mage_Page_Block_Html_Wrapper" name="invitations.list.list.before" as="list_before" translate="label">
                    <label>Invitation List Before</label>
                    <!--action method="setMayBeInvisible"><value>1</value></action-->
                    <action method="setElementClass"><value>rewards</value></action>
                </block>
            </block>
        </reference>
    </enterprise_invitation_index_index>

    <customer_account>
        <block type="Enterprise_Invitation_Block_Link" name="invitation_link_dashboard">
            <action method="addDashboardLink" translate="label" module="Enterprise_Invitation"><block>customer_account_navigation</block><name>invitations</name><path>enterprise_invitation/</path><label>My Invitations</label></action>
        </block>
    </customer_account>

    <enterprise_invitation_customer_account_create translate="label" type="page">
        <parent_node>enterprise_invitation_index_send</parent_node>
        <label>Customer Account Registration by Invitation Form</label>
        <update handle="customer_account_create" />
        <reference name="content">
            <remove name="customer_form_register" />
            <block type="Enterprise_Invitation_Block_Customer_Form_Register" name="customer_form_register_invitation" template="Mage_Customer::form/register.phtml">
                <action method="append"><block>customer.form.register.fields.before</block><alias>form_fields_before</alias></action>
                <action method="append"><block>customer_form_user_attributes</block></action>
                <action method="append"><block>customer_form_address_user_attributes</block></action>
            </block>
        </reference>
    </enterprise_invitation_customer_account_create>
</layout>
