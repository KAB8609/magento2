<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * {license_notice}
 *
 * @category    Enterprise
 * @package     Enterprise_Checkout
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<layout version="0.1.0">
    <checkout_cart_index>
        <reference name="checkout.cart">
            <block type="Enterprise_Checkout_Block_Sku_Products" name="sku.failed.products" template="cart/sku/failed.phtml" as="shopping.cart.table.after">
                <block type="Enterprise_Checkout_Block_Sku_Products_Info" name='additional.product.info' template="cart/sku/failed/info.phtml" />
                <action method="addItemRender"><type>default</type><block>Mage_Checkout_Block_Cart_Item_Renderer</block><template>Enterprise_Checkout::cart/item/failed.phtml</template></action>
                <action method="addItemRender"><type>simple</type><block>Mage_Checkout_Block_Cart_Item_Renderer</block><template>cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>grouped</type><block>Mage_Checkout_Block_Cart_Item_Renderer</block><template>Enterprise_Checkout::cart/item/failed.phtml</template></action>
                <action method="addItemRender"><type>configurable</type><block>Mage_Checkout_Block_Cart_Item_Renderer_Configurable</block><template>cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>bundle</type><block>Mage_Bundle_Block_Checkout_Cart_Item_Renderer</block><template>Mage_Checkout::cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>giftcard</type><block>Enterprise_GiftCard_Block_Checkout_Cart_Item_Renderer</block><template>Mage_Checkout::cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>downloadable</type><block>Mage_Downloadable_Block_Checkout_Cart_Item_Renderer</block><template>Mage_Checkout::cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>virtual</type><block>Mage_Checkout_Block_Cart_Item_Renderer</block><template>cart/item/default.phtml</template></action>
                <action method="addItemRender"><type>undefined</type><block>Mage_Checkout_Block_Cart_Item_Renderer</block><template>Enterprise_Checkout::cart/item/failed.phtml</template></action>
            </block>
        </reference>
    </checkout_cart_index>

    <checkout_cart_configure translate="label" type="page" parent="catalog_product_view">
        <label>Configure Cart Item (Any)</label>
        <update handle="catalog_product_view"/>
        <reference name="product.info">
            <block type="Mage_Checkout_Block_Cart_Item_Configure" name="checkout.cart.item.configure.block"/>
        </reference>
        <reference name="product.info.addtocart">
            <action method="setTemplate"><template>Mage_Checkout::cart/item/configure/updatecart.phtml</template></action>
        </reference>
        <reference name="product.info.addtocart.additional">
            <action method="setTemplate"><template>Mage_Checkout::cart/item/configure/updatecart.phtml</template></action>
        </reference>
    </checkout_cart_configure>

    <checkout_cart_configure_type_downloadable translate="label" module="Mage_Downloadable" type="page" parent="checkout_cart_configure">
        <label>Configure Cart Item (Downloadable)</label>
        <update handle="catalog_product_view_type_downloadable"/>
    </checkout_cart_configure_type_downloadable>

    <checkout_cart_configure_type_configurable translate="label" module="Mage_Catalog" type="page" parent="checkout_cart_configure">
        <label>Configure Cart Item (Configurable)</label>
        <update handle="catalog_product_view_type_configurable"/>
    </checkout_cart_configure_type_configurable>

    <checkout_cart_configure_type_bundle translate="label" module="Mage_Bundle" type="page" parent="checkout_cart_configure">
        <label>Configure Cart Item (Bundle)</label>
        <update handle="catalog_product_view_type_bundle"/>
        <reference name="product.info.addtocart.bundle">
            <action method="setTemplate"><template>Mage_Checkout::cart/item/configure/updatecart.phtml</template></action>
        </reference>
    </checkout_cart_configure_type_bundle>

    <checkout_cart_configurefailed translate="label" type="page" parent="checkout_cart_configure">
        <label>Configure Cart Item Failed</label>
        <update handle="catalog_product_view"/>
        <reference name="product.info">
            <block type="Enterprise_Checkout_Block_Cart_Item_Configure" name="checkout.cart.item.configure.block"/>
        </reference>
    </checkout_cart_configurefailed>

<!--
Customer Account Dashboard
-->

    <customer_account>
        <block type="Enterprise_Checkout_Block_Customer_Link" name="customer_link_sku">
            <action method="addDashboardLink" translate="label" module="Enterprise_Checkout">
                <block>customer_account_navigation</block><name>checkout</name><path>enterprise_checkout/sku</path><label>Order by SKU</label>
            </action>
        </block>
    </customer_account>

    <enterprise_checkout_sku_index translate="label" type="page" parent="checkout_cart_index">
        <label>Customer Checkout by SKU</label>
        <update handle="customer_account"/>
        <reference name="my.account.wrapper">
            <block type="Mage_Core_Block_Template" name="checkout.customer.order" template="Enterprise_Checkout::customer/sku.phtml">
                <block type="Enterprise_Checkout_Block_Customer_Sku" name="checkout.customer.sku" template="widget/sku.phtml">
                    <action method="setIsTitleHidden"><value>true</value></action>
                    <block type="Mage_Core_Block_Template" template="Enterprise_Checkout::customer/file.phtml"></block>
                </block>
            </block>
        </reference>
    </enterprise_checkout_sku_index>
</layout>
