<?php
/**
 * {license_notice}
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   {copyright}
 * @license     {license_link}
 */
/** @var $this Enterprise_Rma_Block_Return_Tracking */
?>

<?php if ($this->getErrorMessage()): ?>
<tr>
    <td colspan="3">
        <ul class="messages">
             <li class="error-msg"><?php echo $this->getErrorMessage() ?></li>
        </ul>
    </td>
</tr>
<?php endif ?>
<?php foreach ($this->getTrackingNumbers() as $number): ?>
<tr>
    <td><?php echo $this->escapeHtml($number->getCarrierTitle()) ?></td>
    <td>
        <a
            href="#"
            onclick="popWin('<?php echo $this->helper('Enterprise_Rma_Helper_Data')->getTrackingPopupUrlBySalesModel($number) ?>','trackshipment','width=800,height=600,top=0,left=0,resizable=yes,scrollbars=yes'); return false;"
            title="<?php echo $this->escapeHtml($number->getTrackNumber()) ?>">
                <?php echo $this->escapeHtml($number->getTrackNumber()) ?>
        </a>
    </td>
    <td>
        <?php if(!$number->getIsAdmin() && $this->isPrintShippingLabelAllowed()): ?>
            <a href="javascript://" onclick="deleteTrackNumber(<?php echo $number->getEntityId()?>)">
                <?php echo $this->__('Delete') ?>
            </a>
        <?php endif ?>
    </td>
</tr>
<?php endforeach ?>
<?php if ($this->getDeleteLabelUrl()): ?>
<script type="text/javascript">
//<![CDATA[
    function deleteTrackNumber(number) {
        if (confirm("<?php echo $this->__('Are you sure you want to delete this tracking information?') ?>")){
            new Ajax.Updater('track-info-tbody', '<?php echo $this->getDeleteLabelUrl() ?>', {
                onCreate: function() { $('rma-please-wait').show() },
                onComplete: function() {
                    $('rma-please-wait').hide();
                    decorateTable('track-info-table');
                },
                parameters : {number: number}
            });
        }
        return false;
    }
//]]>
</script>
<?php endif ?>
