<?php
/**
 * {license_notice}
 *
 * @category    Mage
 * @package     Mage_Launcher
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Launcher_Block_Adminhtml_Storelauncher_Tax_Drawer */
?>
<form action="" id="drawer-form" method="post">
    <?php echo $this->getBlockHtml('formkey')?>

    <div class="switcher drawer-switcher" onselectstart="return false;">
        <input type="checkbox" id="tax-enabled" name="use_tax" checked="checked" value="tax-enabled" />
        <label class="switcher-label"
               for="tax-enabled"
               data-text-on="<?php echo $this->__('Tax rules enabled'); ?>"
               data-text-off="<?php echo $this->__('Tax rules disabled'); ?>"
               title="<?php echo $this->__('Tax Rules Status'); ?>">
        </label>
        <div class="drawer-switcher-tooltip">
            <div class="tooltip-text-on">
                <p><?php echo $this->__('Turn off tax rules here if your business is legally exempt. Legal disclaimer text needed.'); ?></p>
            </div>
            <div class="tooltip-text-off">
                <p><?php echo $this->__('You can always choose to enable tax rules again if you disabled it by mistake'); ?></p>
            </div>
        </div>
    </div>

    <div class="tax-rule-config">
        <div class="tax-rule-info">
            <?php echo $this->getChildHtml('tax-rule-edit');?>
            <?php echo $this->getChildBlock('tax-rule-form')->setUseContainer(false)->toHtml();?>
        </div>

        <?php echo $this->getChildBlock('tax-rate-importExport')->setUseContainer(false)->toHtml();?>

    </div>

    <div class="no-tax-info hidden">
        <h2 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('You have disabled Tax Rules') ?></h2>
        <p><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('You can always choose to enable Tax Rates again if you disabled it by mistake.') ?></p>
        <p><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Consult your local laws regarding taxes. We can recommend tax rates based on your business location if you are in the US.') ?></p>
    </div>

</form>

<?php echo $this->getChildHtml('tax-rate-form'); ?>

<script type="text/javascript">
    (function ($) {
        $(document).ready(function() {
            'use strict';
            var drawerForm = $('#drawer-form'),
                taxRuleConfig = $('.tax-rule-config'),
                noTaxInfo = $('.no-tax-info'),
                drawerSwitcher = '.drawer-header-inner .drawer-switcher :checkbox';

            $('body').on('change.drawerStatus', drawerSwitcher, function() {
                var elem = $(this),
                    elemId = elem.prop('id').replace('copy-','');

                if (elem.is(':checked')) {
                    drawerForm.removeClass('ignore-validate');
                    taxRuleConfig.removeClass('hidden');
                    noTaxInfo.addClass('hidden');
                    $('#' + elemId).prop('checked', true);
                } else {
                    drawerForm.addClass('ignore-validate');
                    taxRuleConfig.addClass('hidden');
                    noTaxInfo.removeClass('hidden');
                    $('#' + elemId).prop('checked', false);
                }
            });
        });
    })(window.jQuery);
</script>
