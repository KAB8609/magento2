<?php
/**
 * {license_notice}
 *
 * @category    Mage
 * @package     Mage_Launcher
 * @copyright   {copyright}
 * @license     {license_link}
 */

/** @var $this Mage_Launcher_Block_Adminhtml_Storelauncher_Shipping_Drawer */

$saveActionUrl = $this->getUrl('*/storelauncher_shipping_drawer/saveShipping');
?>
<div class="shipping-disabled <?php if ($this->isShippingEnabled()): ?>hidden<?php endif; ?>" id="shipping-disabled">
    <h2 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Shipping Disabled') ?></h2>
    <p><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Shipping for your store is now turned off. Use the switch above to turn on shipping.') ?></p>
</div>
<form action="" class="shipping-config-form ignore-validate <?php if (!$this->isShippingEnabled()): ?>disabled<?php endif; ?>" id="drawer-form" method="post">

    <div class="switcher drawer-switcher">
        <input type="checkbox" id="shipping_enabled" name="shipping_enabled" <?php if ($this->isShippingEnabled()): ?> checked="checked" <?php endif; ?> value="1" />
        <label class="switcher-label"
               for="shipping_enabled"
               data-text-on="<?php echo $this->__('Shipping On'); ?>"
               data-text-off="<?php echo $this->__('Shipping Off'); ?>"
               title="<?php echo $this->__('Shipping status'); ?>">
        </label>
        <div class="drawer-switcher-tooltip">
            <div class="tooltip-text-on">
                <p><?php echo $this->__('Turn off shipping here if your products are virtual, digital, or services.'); ?></p>
            </div>
            <div class="tooltip-text-off">
                <p><?php echo $this->__('You can always choose to enable shipping again if you disabled it by mistake.'); ?></p>
            </div>
        </div>
    </div>

    <h2 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Shipping Options'); ?></h2>
    <div class="shipping-vendors" id="shipping-vendors">
        <ul class="shipping-tabs-nav" id="shipping-tabs-nav">
            <li class="active <?php if ($this->getConfigValue('carriers/flatrate/active')): ?> configured <?php endif; ?> ">
                <a href="#flat-rate-config" class="flat-rate-tab-nav" data-toggle="tab"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Flat Rate'); ?></a>
            </li>
            <li <?php if ($this->getConfigValue('carriers/fedex/active')): ?> class="configured" <?php endif; ?> >
                <a href="#fedex-config" class="fedex-tab-nav" data-toggle="tab"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('FedEx'); ?></a>
            </li>
            <li <?php if ($this->getConfigValue('carriers/usps/active')): ?> class="configured" <?php endif; ?> >
                <a href="#usps-config" class="usps-tab-nav" data-toggle="tab"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('USPS'); ?></a>
            </li>
            <li <?php if ($this->getConfigValue('carriers/dhlint/active')): ?> class="configured" <?php endif; ?> >
                <a href="#dhl-config" class="dhl-tab-nav" data-toggle="tab"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('DHL'); ?></a>
            </li>
            <li <?php if ($this->getConfigValue('carriers/ups/active')): ?> class="configured" <?php endif; ?> >
                <a href="#ups-config" class="upc-tab-nav" data-toggle="tab"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('UPS'); ?></a>
            </li>
        </ul>
        <div class="shipping-tab-content">
            <div class="shipping-config flat-rate-config active" id="flat-rate-config">
                <fieldset class="fieldset">
                    <legend class="legend"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Flat-Rate Shipping'); ?></legend>
                    <input type="hidden" name="shipping_method" value="carriers_flatrate">

                    <h3 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Flat Rate Shipping'); ?></h3>
                    <p class="shipping-tagline"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Charge a single flat rate to ship your products.'); ?></p>

                    <div class="field field-flat-rate-name required">
                        <label for="flat-rate-name" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Display Name'); ?></span>
                        </label>
                        <div class="control">
                            <input type="text" class="input-text required-entry" id="flat-rate-name" name="groups[flatrate][fields][name][value]" value="<?php echo $this->getConfigValue('carriers/flatrate/name'); ?>">
                        </div>
                    </div>

                    <div class="field field-flat-rate-price required">
                        <label for="flat-rate-price" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Price'); ?></span>
                        </label>
                        <div class="control">
                            <input type="text" class="input-text validate-number validate-zero-or-greater required-entry" id="flat-rate-price" name="groups[flatrate][fields][price][value]" value="<?php echo $this->getConfigValue('carriers/flatrate/price'); ?>">
                        </div>
                    </div>

                    <div class="field field-flat-rate-type">
                        <label for="flat-rate-type" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Type'); ?></span>
                        </label>
                        <div class="control">
                            <select id="flat-rate-type" name="groups[flatrate][fields][type][value]">
                                <option<?php if ($this->getConfigValue('carriers/flatrate/type') == 'O'): ?> selected="selected"<?php endif; ?> value="O">Per Order</option>
                                <option<?php if ($this->getConfigValue('carriers/flatrate/type') == 'I'): ?> selected="selected"<?php endif; ?> value="I">Per Item</option>
                            </select>
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" class="action-save-method primary" data-save-url="<?php echo $saveActionUrl; ?>">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Save Flat Rate Settings'); ?></span>
                        </button>
                    </div>
                </fieldset>
            </div>
            <div class="shipping-config fedex-config" id="fedex-config">
                <fieldset class="fieldset">
                    <legend class="legend"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('FedEx'); ?></legend>
                    <input type="hidden" name="shipping_method" value="carriers_fedex">

                    <h3 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('FedEx Settings'); ?></h3>
                    <p class="shipping-tagline"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Set up FedEx shipping method to ship your products.'); ?></p>

                    <div class="field field-fedex-id required">
                        <label for="fedex-id" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Account ID'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="fedex-id" name="groups[fedex][fields][account][value]" value="<?php echo $this->getObscuredConfigValue('carriers/fedex/account'); ?>">
                        </div>
                    </div>

                    <div class="field field-fedex-meter-number required">
                        <label for="fedex-meter-number" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Meter Number'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="fedex-meter-number" name="groups[fedex][fields][meter_number][value]" value="<?php echo $this->getObscuredConfigValue('carriers/fedex/meter_number'); ?>">
                        </div>
                    </div>

                    <div class="field field-fedex-key required">
                        <label for="fedex-key" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Key'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="fedex-key" name="groups[fedex][fields][key][value]" value="<?php echo $this->getObscuredConfigValue('carriers/fedex/key'); ?>">
                        </div>
                    </div>

                    <div class="field field-fedex-password required">
                        <label for="fedex-password" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Password'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="fedex-password" name="groups[fedex][fields][password][value]" value="<?php echo $this->getObscuredConfigValue('carriers/fedex/password'); ?>">
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" class="action-save-method primary" data-save-url="<?php echo $saveActionUrl; ?>">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Save FedEx Settings'); ?></span>
                        </button>
                    </div>
                </fieldset>
            </div>

            <div class="shipping-config usps-config" id="usps-config">
                <fieldset class="fieldset">
                    <legend class="legend"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('USPS'); ?></legend>
                    <input type="hidden" name="shipping_method" value="carriers_usps">

                    <h3 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('USPS Settings'); ?></h3>
                    <p class="shipping-tagline"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Set up USPS shipping method to ship your products.'); ?></p>

                    <div class="field field-usps-id required">
                        <label for="usps-id" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('User ID'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="usps-id" name="groups[usps][fields][userid][value]" value="<?php echo $this->getObscuredConfigValue('carriers/usps/userid'); ?>">
                        </div>
                    </div>

                    <div class="field field-usps-password required">
                        <label for="usps-password" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Password'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="usps-password" name="groups[usps][fields][password][value]" value="<?php echo $this->getObscuredConfigValue('carriers/usps/password'); ?>">
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" class="action-save-method primary" data-save-url="<?php echo $saveActionUrl; ?>">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Save USPS Settings'); ?></span>
                        </button>
                    </div>
                </fieldset>
            </div>

            <div class="shipping-config dhl-config" id="dhl-config">
                <fieldset class="fieldset">
                    <legend class="legend"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('DHL'); ?></legend>
                    <input type="hidden" name="shipping_method" value="carriers_dhlint">

                    <h3 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('DHL Settings'); ?></h3>
                    <p class="shipping-tagline"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Set up DHL shipping method to ship your products.'); ?></p>

                    <div class="field field-dhl-id required">
                        <label for="dhl-id" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Access ID'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="dhl-id" name="groups[dhlint][fields][id][value]" value="<?php echo $this->getObscuredConfigValue('carriers/dhlint/id'); ?>">
                        </div>
                    </div>

                    <div class="field field-dhl-password required">
                        <label for="dhl-password" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Password'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="dhl-password" name="groups[dhlint][fields][password][value]" value="<?php echo $this->getObscuredConfigValue('carriers/dhlint/password'); ?>">
                        </div>
                    </div>

                    <div class="field field-dhl-account-number required">
                        <label for="dhl-account-number" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Account Number'); ?></span>
                        </label>
                        <div class="control">
                            <input type="text" class="input-text required-entry" id="dhl-account-number" name="groups[dhlint][fields][account][value]" value="<?php echo $this->getConfigValue('carriers/dhlint/account'); ?>">
                        </div>
                    </div>

                     <div class="actions">
                        <button type="button" class="action-save-method primary" data-save-url="<?php echo $saveActionUrl; ?>">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Save DHL Settings'); ?></span>
                        </button>
                    </div>
                </fieldset>
            </div>

            <div class="shipping-config ups-config" id="ups-config">
                <fieldset class="fieldset">
                    <legend class="legend"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('UPS'); ?></legend>
                    <input type="hidden" name="shipping_method" value="carriers_ups">

                    <h3 class="title"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('UPS Settings'); ?></h3>
                    <p class="shipping-tagline"><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Set up UPS shipping method to ship your products.'); ?></p>

                    <div class="field field-ups-password required">
                        <label for="ups-password" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Password'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="ups-password" name="groups[ups][fields][password][value]" value="<?php echo $this->getObscuredConfigValue('carriers/ups/password'); ?>">
                        </div>
                    </div>

                    <div class="field field-ups-license-number required">
                        <label for="ups-license-number" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Access License Number'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="ups-license-number" name="groups[ups][fields][access_license_number][value]" value="<?php echo $this->getObscuredConfigValue('carriers/ups/access_license_number'); ?>">
                        </div>
                    </div>

                    <div class="field field-ups-user-id required">
                        <label for="ups-user-id" class="label">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('User ID'); ?></span>
                        </label>
                        <div class="control">
                            <input type="password" class="input-text required-entry" id="ups-user-id" name="groups[ups][fields][username][value]" value="<?php echo $this->getObscuredConfigValue('carriers/ups/username'); ?>">
                        </div>
                    </div>

                    <div class="actions">
                        <button type="button" class="action-save-method primary" data-save-url="<?php echo $saveActionUrl; ?>">
                            <span><?php echo Mage::helper('Mage_Launcher_Helper_Data')->__('Save UPS Settings'); ?></span>
                        </button>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
    <div class="disabled-mask"></div>
</form>
<div id="shipping-origin-address-wrapper"
     class="<?php if (!$this->isShippingEnabled()): ?>disabled<?php endif; ?> shipping-origin-address-wrapper">
    <?php echo $this->getChildBlock('shipping-origin-address')->toHtml(); ?>
    <div class="disabled-mask"></div>
</div>
<script type="text/javascript">
    (function ($) {
        $(document).ready(function() {
            'use strict';

            var toggleCheckbox = '.drawer-header-inner .drawer-switcher :checkbox',
                drawerHeader = $('.drawer-header');

            $('.action-save-method').partiallyValidateDrawer({'currentSection': '.shipping-tabs-nav'});

            drawerHeader.unbind('change');
            drawerHeader.on('change', toggleCheckbox, function() {
                $(toggleCheckbox).toggleStatus({
                    'disabledMessage': '.shipping-disabled',
                    'formsToDisable': ['.shipping-config-form', '.shipping-origin-address-wrapper'],
                    'needValidate': false
                });
            });
        });
    })(jQuery);
</script>
