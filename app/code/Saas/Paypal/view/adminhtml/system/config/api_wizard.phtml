<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * @see Mage_Paypal_Block_Adminhtml_System_Config_ApiWizard
 */
/** @var $this Mage_Paypal_Block_Adminhtml_System_Config_ApiWizard */
?>
<script type="text/javascript">
var APIWizard = Class.create({
    initialize : function(){
        this.credentialsUrl = '<?php echo $this->getButtonUrl(); ?>';
        this.credentialsUrl = this.credentialsUrl.evalJSON();

        this.sandboxUrl = '<?php echo $this->getSandboxButtonUrl(); ?>';
        this.sandboxUrl = this.sandboxUrl.evalJSON();
    },
    navigateToCredentialsPage : function(){
        if (typeof(this.credentialsUrl) == 'object') {
            var country = $('payment_account_merchant_country').value;
            var url = typeof(this.credentialsUrl[country]) == 'string'
                ? this.credentialsUrl[country]
                : (typeof(this.credentialsUrl['default']) == 'string' ? this.credentialsUrl['default'] : '');
            this.navigate(url);
        } else if (typeof(this.credentialsUrl) == 'string') {
            this.navigate(this.credentialsUrl);
        }
        return false;
    },
    navigateToSandboxPage : function(){
        if (typeof(this.sandboxUrl) == 'object') {
            var country = $('payment_account_merchant_country').value;
            var url = typeof(this.sandboxUrl[country]) == 'string'
                ? this.sandboxUrl[country]
                : (typeof(this.sandboxUrl['default']) == 'string' ? this.sandboxUrl['default'] : '');
            this.navigate(url);
        } else if (typeof(this.sandboxUrl) == 'string') {
            this.navigate(this.sandboxUrl);
        }
        return false;
    },
    navigate : function (url){
        window.open(url, 'apiwizard', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, ,left=100, top=100, width=380, height=470');
    }
});
var apiW = new APIWizard;
</script>

<div class="pp-buttons-container">
    <button style="" onclick="javascript:apiW.navigateToCredentialsPage(); return false;" class="scalable" type="button" id="<?php echo $this->getHtmlId() ?>">
        <span><span><span><?php echo $this->escapeHtml($this->getButtonLabel()); ?></span></span></span>
    </button>
    <button style="" onclick="javascript:apiW.navigateToSandboxPage(); return false;" class="scalable" type="button" id="<?php echo $this->getSandboxHtmlId() ?>">
        <span><span><span><?php echo $this->escapeHtml($this->getSandboxButtonLabel()); ?></span></span></span>
    </button>
</div>