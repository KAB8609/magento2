<?=$breadcrumbs?>
<script src="<?=$baseJsUrl?>scriptaculous/scriptaculous.js" type="text/javascript"></script>
<script src="<?=$baseSkinUrl?>catalog/js/product.js" type="text/javascript"></script>
<div class="product-image">
    <div style="position:relative; overflow:hidden; width:245px; height:245px;">
        <img id="image" src="<?=$baseSkinUrl?>catalog/images/placeholder_product_main.jpg" alt="<?=$product->getName()?>" style="width:100%; position:absolute; top:0; left:0; cursor:move; z-index:999;" ondblclick="toggleFull()"/>
    </div>   
    <div style="margin-top:10px;">
        <table border=0 cellspacing=2><tr><td><img src="<?=$baseSkinUrl?>catalog/images/magnifier_zoom_out.png" width=16></td><td>
        <div id="track1" style="width: 200px; height:18px; background:#CCC;">
          <div id="handle1"" style="width: 8px; height: 18px; background:#557;">
            
          </div>
        </div>
        </td><td><img src="<?=$baseSkinUrl?>catalog/images/magnifier_zoom_in.png" width=16></td></tr></table>
        <script type="text/javascript">
            var image = new Draggable('image', {starteffect:false, reverteffect:false, endeffect:false, snap:containIt});
            
            var slider = new Control.Slider('handle1','track1', {axis:'horizontal', minimum:0, maximum:200, alignX:1, increment:1, sliderValue:0, onSlide:scaleIt, onChange:scaleIt});

            var origWidth = 245;
            var origHeight = 300;
            var floorSize = 1.0;
            var ceilingSize = 10.0;
            var imageX = 0;
            var imageY = 0;
            var imageV = 1;
            var showFull = false;
            var selects = document.getElementsByTagName('select');
            
            function toggleFull()
            {
                showFull = !showFull;
                //TODO: hide selects for IE only
                for (i=0; i<selects.length; i++) {
                    selects[i].style.visibility = showFull ? 'hidden' : 'visible';
                }
                $('track1').style.visibility = showFull ? 'hidden' : 'visible';
                image.element.parentNode.style.overflow = showFull ? 'visible' : 'hidden';
            }
            
            function scaleIt(v) {
              var centerX = (origWidth*(1-imageV)/2-imageX)/imageV;
              var centerY = (origHeight*(1-imageV)/2-imageY)/imageV;

              imageV = floorSize+(v*(ceilingSize-floorSize));
              
              image.element.style.width = (imageV*origWidth)+'px';
              
              imageX = origWidth*(1-imageV)/2-centerX*imageV;
              imageY = origHeight*(1-imageV)/2-centerY*imageV;
              containIt(imageX, imageY, image);
              
              image.element.style.left = imageX+'px';
              image.element.style.top = imageY+'px';
            }
            
            function containIt(x,y,draggable) {
                var pDim = Element.getDimensions(draggable.element.parentNode); 
                var eDim = Element.getDimensions(draggable.element);
                var xMin = 0, xMax = pDim.width-eDim.width;
                var yMin = 0, yMax = pDim.height-eDim.height;
                x = x>xMin ? xMin : x;
                x = x<xMax ? xMax : x;
                y = y>yMin ? yMin : y;
                y = y<yMax ? yMax : y;
                imageX = x;
                imageY = y;
                return [x,y];
            }
        </script>
    </div>
</div>
<form action="<?=Mage::getUrl('checkout', array('controller'=>'cart', 'action'=>'add'))?>" method="POST">
<input type="hidden" name="product_id" value="<?=$product->getProductId()?>">
<div class="product-info">
<h1 class="page-heading"><?=$product->getName()?></h1>
<div class="product-description"><?=$product->getDescription()?></div>
<table cellspacing="0" width="100%" class="qty-list">
    <thead>
        <tr>
            <th class="top-left align-center">Quantity</th>
            <th class="top-right align-center ">Price Each</th>
            <!--<th class="top-right price">Total</th>-->
        </tr>
    </thead>
    <tfoot>
        <tr>
            <td colspan="3" class="bottom">
            <!--
            <div>
                <a href="#">
                    <img src="<?=$baseSkinUrl?>catalog/images/icon_shipping_costs.png" alt="View Shipping Costs" class="vmiddle" />
                </a>
                <a href="#"><strong>View Shipping Costs</strong></a>
            </div>
            -->
            </td>
        </tr>
    </tfoot>
    <?$_prices=$product->getTierPrice()?>
    <tbody>
    <?foreach($_prices as $_price):?>
        <tr>
            <td class="align-center"><?=$_price['price_qty']?></td>
            <td class="align-center"><?=$currencyFilter->filter($_price['price'])?></td>
            <!--<td class="price">$<?=$product->getPrice()?></td>-->
        </tr>
    <?endforeach?>
    </tbody>
</table>
<input type="image" src="<?=$baseSkinUrl?>catalog/images/btn_add_to_cart.gif" alt="Add to Cart" class="float-left" />
<ul class="product-options">
<!--
    <li>
        <a href="#" title="Request a Sample"><img src="<?=$baseSkinUrl?>catalog/images/icon_request_sample.gif" alt="Request a Sample" /></a> 
        <a href="#" title="Request a Sample"><strong>Request a Sample</strong></a>
    </li>
    <li>
        <a href="#" title="Tell-a-Friend"><img src="<?=$baseSkinUrl?>catalog/images/icon_tell_friend.gif" alt="Request a Sample" /></a> 
        <a href="#" title="Tell-a-Friend"><strong>Tell-a-friend</strong></a>
    </li>
-->
    <?#if($customerIsLogin):?>
    <li>
        <a href="#"><img src="<?=$baseSkinUrl?>catalog/images/icon_add_favorites.gif" alt="Add to Wishlist" /></a> 
        <a href="<?=Mage::getUrl('customer', array('controller'=>'wishlist', 'action'=>'add', 'product'=>$product->getId()))?>"><strong>Add to Wishlist</strong></a>
    </li>
    <?#else:?>
    <li>&nbsp;</li>
    <?#endif?>
</ul>
<div class="dotted-separator"></div>
<h3 class="red">Satisfaction Guaranteed</h3>
<p>If you are not completely satisfied with your order return it for a full refund!</p>
<div class="dotted-separator"></div>
<img src="<?=$baseSkinUrl?>catalog/images/icon_made_in_america.gif" alt="Made in USA" /></div>
</form>
<?$_relatedProducts=$product->getRelatedProducts()?>
<?if($_relatedProducts->getSize()):?>
<div class="clearfix"></div>
<h1>Related products</h1>
    <div class="catalog-spacer">&nbsp;</div>
        <div class="catalog-collection">
            <?foreach ($_relatedProducts as $_link):?>
            <div class="item">
                <div class="item-image">
                    <a href="<?=$_link->getProduct()->getProductUrl()?>"><img src="<?=$baseSkinUrl?>catalog/images/placeholder_product_small.jpg" alt="product name" width="115"/></a>
                </div>
                <div class="item-info">
                    <div class="product-name"><a href="<?=$_link->getProduct()->getProductUrl()?>" title="<?=$_link->getProduct()->getName()?>"><?=$_link->getProduct()->getName()?></a></div>
                    <div class="product-price"><?=$_link->getProduct()->getFormatedPrice()?></div>
                </div>
            </div>
            <?endforeach?>
            <div class="clearfix"></div>
    </div>
<?endif?>
<div class="clearfix" style="height: 20px;">&nbsp;</div>