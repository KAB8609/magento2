<?php
/**
 * Credentials for mongoDB
 * Create indexes for mongo db
 * db.tenantConfiguration.ensureIndex({tenantId: 1}, {unique: true});
 */
define('SAAS_MONGO_DSN', 'mongodb://<% mongo_hostport = Array.new ; $mongo.each {|hostport| mongo_hostport << hostport.join(":") } %><%=mongo_hostport.join(",")%>');
define('SAAS_MONGO_IS_PERSIST', '<%= $mongo_persist %>');
define('SAAS_MONGO_IS_REPLICA', '<%= $mongo_replica_set %>');
define('SAAS_MONGO_IS_SLAVE_OKAY', '<%= $saas_mongo_is_slave_okay ? $saas_mongo_is_slave_okay : 0 %>');
define('SAAS_MONGO_DATABASE', 'tenantsManagement');

/**
 * Directory with all Magento versions
 */
define('SAAS_MAGENTO_DIR', dirname(__DIR__) . '/magento');

/**
 * Geerman configuration
 */
define('SAAS_WORKER_GEARMAN_SERVERS', '<% gearman_hostport = Array.new ; $gearman.each {|hostport| gearman_hostport << hostport.join(":") } %><%=gearman_hostport.join(",")%>');

// web node parameters
define('SAAS_WEBNODE_NO_TENANT_LINK', 'http://golinks.magento.com/noStore');

// worker parameters
define('SAAS_WORKER_CHILDREN_COUNT', <%= $saas_worker_children_count %>);

// Should parent worker save his process id ? (0 - no, 1 - yes)
define('SAAS_WORKER_PID_SAVE', <%= $saas_worker_pid_save %>);

// Worker parent process ids directory
define('SAAS_WORKER_PID_DIRECTORY', '<%= $saas_worker_pid_directory %>');

/**
 * Name of current Saas instance
 */
define('TMT_INSTANCE_NAME', '<%= $tmt_instance_name %>');

/**
 * Default locale for current Saas instance
 */
define('TMT_INSTANCE_DEFAULT_REGION', '<%= $tmt_instance_default_region %>');

/**
 * Totango service ID
 */
define('TOTANGO_SERVICE_ID', '<%= $totango_service_id %>');

/**
 * Credentials for tmt_api_log database

    CREATE TABLE `magento_api_log` (
     `log_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
     `time` INT(15) NOT NULL COMMENT 'API call datetime',
     `tenant_id` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Tenant ID',
     `proto` VARCHAR(10) NULL DEFAULT NULL COMMENT 'API Protocol',
     `request` VARCHAR(1024) NULL DEFAULT NULL COMMENT 'API call request',
     `response` VARCHAR(1024) NULL DEFAULT NULL COMMENT 'API call response',
     `error` VARCHAR(1024) NULL DEFAULT NULL COMMENT 'API call error',
     `duration` FLOAT NULL DEFAULT NULL COMMENT 'API call duration',
     `ip` BIGINT(20) NULL DEFAULT NULL COMMENT 'Source IP',
     PRIMARY KEY (`log_id`)
    )
    COMMENT='Magento API log'
    COLLATE='latin1_swedish_ci'
    ENGINE=InnoDB
    ROW_FORMAT=DEFAULT;
 */
define('TMT_LOG_DSN', 'mysql:host=<%= $logging_db_host %>;port=<%= $logging_db_port %>;dbname=<%= $logging_db_name %>');
define('TMT_LOG_USER', '<%= $logging_db_user %>');
define('TMT_LOG_PASSWORD', '<%= $logging_db_pass %>');

require __DIR__ . '/Saas/Db/WrongTenantException.php';
require __DIR__ . '/Saas/Db.php';
require __DIR__ . '/Saas/Tenant/Loader.php';
require __DIR__ . '/Saas/Tenant.php';
require __DIR__ . '/Saas/Tenant/CodeBase.php';
require __DIR__ . '/Saas/Region/Domain.php';
