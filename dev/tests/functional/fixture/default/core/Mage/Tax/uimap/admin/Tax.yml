#
# {license_notice}
#
# @category    Magento
# @package     Mage_Tax
# @subpackage  functional_tests
# @copyright   {copyright}
# @license     {license_link}
#
---
## Customer Tax Class and related pages

# Manage Tax Rate and related pages
# 'Manage Tax Zones and Rates' page
manage_tax_zones_and_rates:
    mca: tax_rate/
    click_xpath: //ul[@id='nav']//a[contains(@href, 'tax_rate') and not(contains(@href, 'importExport'))]
    title: Manage Tax Zones and Rates / Tax / Sales / Magento Admin
    uimap:
        form: &searchTaxRatesGrid
            fieldsets:
                -
                    manage_tax_rate:
                        xpath: //div[@id='tax_rate_grid']
                        buttons:
                            reset_filter: //button[span='Reset Filter']
                            search: //button[span='Search']
                            export: //button[span='Export']
                        dropdowns:
                            filter_country: //select[@id='tax_rate_grid_filter_tax_country_id']
                            view: //select[@name='limit']
                            export_to: //select[@id='tax_rate_grid_export']
                        fields:
                            filter_tax_id: //input[@id='tax_rate_grid_filter_code']
                            filter_state_region: //input[@id='tax_rate_grid_filter_region_name']
                            filter_zip_code: //input[@id='tax_rate_grid_filter_tax_postcode']
                            filter_rate_from: //input[@id='tax_rate_grid_filter_rate_from']
                            filter_rate_to: //input[@id='tax_rate_grid_filter_rate_to']
                            page: //input[@name='page']
                        pageelements:
                            grid_head: //*[@id='tax_rate_grid_table']/thead/tr[@class='headings']
        buttons:
            add_rate: //button[span='Add New Tax Rate']
        messages:
            success_saved_tax_rate: //li[normalize-space(@class)='success-msg' and contains(.,'The tax rate has been saved.')]
            success_deleted_tax_rate: //li[normalize-space(@class)='success-msg' and contains(.,'The tax rate has been deleted.')]

# 'New Tax Rate' Page
create_tax_rate:
    mca: tax_rate/add/
    title: New Rate / Manage Tax Zones and Rates / Tax / Sales / Magento Admin
    uimap:
        form: &newTaxRatesForm
            fieldsets:
                -
                    tax_rate_info:
                        xpath: //div[@id='base_fieldset']
                        dropdowns:
                            country: //select[@id='tax_country_id']
                            state: //select[@id='tax_region_id']
                            zip_is_range: //select[@id='zip_is_range']
                        fields:
                            tax_identifier: //input[@id='code']
                            zip_postal_code: //input[@id='tax_postcode']
                            zip_range_from: //input[@id='zip_from']
                            zip_range_to: //input[@id='zip_to']
                            rate_percent: //input[@id='rate']
                        required: [tax_identifier, country, rate_percent]
                -
                    tax_titles:
                        xpath: //div[contains(h4,'Tax Titles')]/following-sibling::*[1]
                        fields:
                            tax_title: //td[%storeNumber%]/input
                        pageelements:
                            tax_title_header: //table[@class='form-list']//tbody/tr[@class='dynamic-grid']/th
                            tax_title_header_index: //table[@class='form-list']//tbody/tr[@class='dynamic-grid']/th[%index%]
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            save_rate: //button[@data-ui-id='tax-rate-toolbar-save-savebutton']
        messages: &newTaxRateMessages
            code_already_exists: //li[normalize-space(@class)='error-msg' and contains(.,'Code already exists.')]
            error_delete_tax_rate: //li[normalize-space(@class)='error-msg' and contains(.,'Tax rate cannot be removed. It exists in tax rule')]
            empty_required_field: "//div[@id='advice-required-entry-%fieldId%' and not(contains(@style,'display: none;'))]"
            enter_not_negative_number: "//div[@id='advice-validate-not-negative-number-%fieldId%' and not(contains(@style,'display: none;'))]"
            enter_valid_digits: "//div[@id='advice-validate-digits-%fieldId%' and not(contains(@style,'display: none;'))]"
            generic_validation_error: "//div[contains(@id, 'advice-') and contains(@id, '-%fieldId%') and not(contains(@style,'display: none;'))]"
            confirmation_for_delete: Are you sure you want to do this?

# 'Edit Tax Rate' Page
edit_tax_rate:
    mca: tax_rate/edit/rate/%rate%/
    title: %elementTitle% / Manage Tax Zones and Rates / Tax / Sales / Magento Admin
    uimap:
        form: &editTaxRatesForm
            fieldsets:
                -
                    tax_rate_info:
                        xpath: //div[@id='base_fieldset']
                        dropdowns:
                            country: //select[@id='tax_country_id']
                            state: //select[@id='tax_region_id']
                            zip_is_range: //select[@id='zip_is_range']
                        fields:
                            tax_identifier: //input[@id='code']
                            zip_postal_code: //input[@id='tax_postcode']
                            zip_range_from: //input[@id='zip_from']
                            zip_range_to: //input[@id='zip_to']
                            rate_percent: //input[@id='rate']
                        required: [tax_identifier, country, rate_percent]
                -
                    tax_titles:
                        xpath: //div[contains(h4,'Tax Titles')]/following-sibling::*[1]
                        fields:
                            tax_title: //td[%storeNumber%]/input
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            delete_rate: //button[span='Delete Rate']
            save_rate: //button[@data-ui-id='tax-rate-toolbar-save-savebutton']
        messages: *newTaxRateMessages

#Import/Export Tax Rates
manage_import_export_tax_rates:
    mca: tax_rate/importExport/
    click_xpath: //ul[@id='nav']//a[contains(@href, 'tax_rate/import')]
    title: Import and Export Tax Rates / Manage Tax Zones and Rates / Tax / Sales / Magento Admin
    uimap:
        form: &salesImportExportTaxRates
            fieldsets:
                -
                    sales_tax_import_tax_reates:
                        xpath: //div[@class='entry-edit']/div[@class='box-left']
                        buttons:
                            import_tax_rates: //button[span='Import Tax Rates']
                        fields:
                            import: //input[@name='import_rates_file']
                -
                    sales_tax_export_tax_reates:
                        xpath: //div[@class='entry-edit']/div[@class='box-right']
                        buttons:
                            export_tax_rates: //button[span='Export Tax Rates']
        messages:
            invalid_file_upload_attempt: //li[normalize-space(@class)='error-msg' and contains(.,'Invalid file upload attempt')]
            invalid_file_format_upload_attempt: //li[normalize-space(@class)='error-msg' and contains(.,'Invalid file format upload attempt')]

# Manage Tax Rules and related pages
# Manage Tax Rules page
manage_tax_rule:
    mca: tax_rule/
    click_xpath: //ul[@id='nav']//a[contains(@href, 'tax_rule')]
    title: Manage Tax Rules / Tax / Sales / Magento Admin
    uimap:
        form: &searchTaxRulesGrid
            fieldsets:
                -
                    manage_tax_rule:
                        xpath: //div[@id='taxRuleGrid']
                        buttons:
                            reset_filter: //button[span='Reset Filter']
                            search: //button[span='Search']
                        dropdowns:
                            view_per_page: //select[@name='limit']
                            filter_customer_tax_class: //select[@id='taxRuleGrid_filter_customer_tax_classes']
                            filter_product_tax_class: //select[@id='taxRuleGrid_filter_product_tax_classes']
                            filter_tax_rate: //select[@id='taxRuleGrid_filter_tax_rates']
                        fields:
                            page: //input[@name='page']
                            filter_name: //input[@id='taxRuleGrid_filter_code']
                            filter_priority: //input[@id='taxRuleGrid_filter_priority']
                            filter_sort_order: //input[@id='taxRuleGrid_filter_position']
                        pageelements:
                            grid_head: //*[@id='taxRuleGrid_table']/thead/tr[@class='headings']
                            rules_table: //*[@id='taxRuleGrid_table']/tbody
                            rule_line: //*[@id='taxRuleGrid_table']/tbody//tr[@title]
        buttons:
            add_rule: //button[span='Add New Tax Rule']
        messages:
            success_saved_tax_rule: //li[normalize-space(@class)='success-msg' and contains(.,'The tax rule has been saved.')]
            success_deleted_tax_rule: //li[normalize-space(@class)='success-msg' and contains(.,'The tax rule has been deleted.')]

# Add New Tax Rule page
create_tax_rule:
    mca: tax_rule/new/
    title: New Rule / Manage Tax Rules / Tax / Sales / Magento Admin
    uimap:
        form: &create_tax_rule-form
            fieldsets:
                -
                    tax_rule_info:
                        xpath: //form[div/h4='Tax Rule Information']
                        fields:
                            name: //input[@id='code']
                        composite_multiselects:
                            tax_rate: //tr[@data-ui-id='tax-rate-form-fieldset-element-form-row-tax-rate']//section
                -
                    tax_rule_info_additional:
                        xpath: //div[h3[@id='advanced_block_title']]
                        links:
                            tax_rule_info_additional_link: /h3/span
                        fields:
                            priority: //input[@id='priority']
                            sort_order: //input[@id='position']
                        composite_multiselects:
                            customer_tax_class: //tr[@data-ui-id='tax-rate-form-fieldset-element-form-row-tax-customer-class']//section
                            product_tax_class: //tr[@data-ui-id='tax-rate-form-fieldset-element-form-row-tax-product-class']//section
                -
                    import_tax_rates:
                        xpath: //form[div/h4='Import Tax Rates']
                        buttons:
                            export_tax_rates: //button[@title='Import Tax Rates']
                -
                    export_tax_rates:
                        xpath: //form[div/h4='Export Tax Rates']
                        buttons:
                            export_tax_rates: //button[@title='Export Tax Rates']
                -
                    new_tax_rate:
                        xpath: //div[div/span='Tax Rate']
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            save_rule: //button[@data-ui-id='content-schedule-block-save-button']
            save_and_continue_edit: //button[@data-ui-id='content-schedule-block-save-and-continue-button']
        messages: &newTaxRuleMessages
            code_already_exists: //li[normalize-space(@class)='error-msg' and contains(.,'Code already exists.')]
            empty_required_field:  "//div[@id='advice-required-entry-%fieldId%' and not(contains(@style,'display: none;'))]"
            enter_not_negative_number: "//div[@id='advice-validate-not-negative-number-%fieldId%' and not(contains(@style,'display: none;'))]"
            generic_validation_error: "//div[contains(@id, 'advice-') and contains(@id, '-%fieldId%') and not(contains(@style,'display: none;'))]"
            tax_class_exists: An error occurred while saving this tax class. A class with the same name already exists.
            confirmation_for_delete_rule: Are you sure you want to do this?
            confirmation_for_delete_rate: Do you really want to delete this tax rate?
            confirmation_for_delete_class: Do you really want to delete this tax class?
            used_in_rule_error: You cannot delete this tax class as it is used in Tax Rules. You have to delete the rules it is used in first.
            used_in_product_error: You cannot delete this tax class as it is used for 1 products.

# Edit Tax Rule page
edit_tax_rule:
    mca: tax_rule/edit/rule/%rule%/
    title: %elementTitle% / Manage Tax Rules / Tax / Sales / Magento Admin
    uimap:
        form: *create_tax_rule-form
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            delete_rule: //button[span='Delete Rule']
            save_rule: //button[@data-ui-id='content-schedule-block-save-button']
            save_and_continue_edit: //button[@data-ui-id='content-schedule-block-save-and-continue-button']
        messages: *newTaxRuleMessages